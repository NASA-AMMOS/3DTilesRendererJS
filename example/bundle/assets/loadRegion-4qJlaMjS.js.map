{"version":3,"file":"loadRegion-4qJlaMjS.js","sources":["../../../src/three/plugins/LoadRegionPlugin.js","../../three/loadRegion.js"],"sourcesContent":["import { Ray, Sphere } from 'three';\nimport { OBB } from '3d-tiles-renderer/three';\n\nexport class LoadRegionPlugin {\n\n\tconstructor() {\n\n\t\tthis.name = 'LOAD_REGION_PLUGIN';\n\t\tthis.regions = [];\n\t\tthis.tiles = null;\n\n\t}\n\n\tinit( tiles ) {\n\n\t\tthis.tiles = tiles;\n\n\t}\n\n\taddRegion( region ) {\n\n\t\tif ( this.regions.indexOf( region ) === - 1 ) {\n\n\t\t\tthis.regions.push( region );\n\n\t\t}\n\n\t}\n\n\tremoveRegion( region ) {\n\n\t\tconst index = this.regions.indexOf( region );\n\t\tif ( index !== - 1 ) {\n\n\t\t\tthis.regions.splice( index, 1 );\n\n\t\t}\n\n\t}\n\n\thasRegion( region ) {\n\n\t\treturn this.regions.indexOf( region ) !== - 1;\n\n\t}\n\n\tclearRegions() {\n\n\t\tthis.regions = [];\n\n\t}\n\n\t// Calculates shape intersections and associated error values to use. If \"mask\" shapes are present then\n\t// tiles are only loaded if they are within those shapes.\n\tcalculateTileViewError( tile, target ) {\n\n\t\tconst boundingVolume = tile.engineData.boundingVolume;\n\t\tconst { regions, tiles } = this;\n\n\t\t// \"inShape\" indicates whether the tile intersects the given shape.\n\t\t// \"inMask\" indicates whether the tile is _within_ a mask if boolean, if\n\t\t// null then it is ignored.\n\t\t// \"maxError\" is the maximum error from the shapes.\n\t\tlet inShape = false;\n\t\tlet inMask = null;\n\t\tlet maxError = 0;\n\t\tlet minDistance = Infinity;\n\t\tfor ( const region of regions ) {\n\n\t\t\t// TODO: we should only set the error if it is \"intersected\".\n\n\t\t\t// Check if the tile is intersecting the shape and calculate the\n\t\t\t// view and error values.\n\t\t\tconst intersects = region.intersectsTile( boundingVolume, tile, tiles );\n\t\t\tinShape = inShape || intersects;\n\n\t\t\tif ( intersects ) {\n\n\t\t\t\tmaxError = Math.max( region.calculateError( tile, tiles ), maxError );\n\t\t\t\tminDistance = Math.min( region.calculateDistance( boundingVolume, tile, tiles ), minDistance );\n\n\t\t\t}\n\n\t\t\t// Store whether the tile is in a \"mask\" shape if they exist. If \"inMask\" is\n\t\t\t// still \"null\" by the end of the loop then there are no mask elements.\n\t\t\tif ( region.mask ) {\n\n\t\t\t\tinMask = inMask || intersects;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// A tile should only be visible if it intersects a shape and a mask shape or there\n\t\t// are no masks.\n\t\ttarget.inView = inShape && inMask !== false;\n\t\ttarget.error = maxError;\n\t\ttarget.distance = minDistance;\n\n\t\t// Returning \"false\" indicates \"no operation\" and all results will be ignored.\n\t\treturn target.inView || inMask !== null;\n\n\t}\n\n\tdispose() {\n\n\t\tthis.regions = [];\n\n\t}\n\n}\n\n// Definitions of predefined regions\nexport class BaseRegion {\n\n\tconstructor( options = {} ) {\n\n\t\tif ( typeof options === 'number' ) {\n\n\t\t\tconsole.warn( 'LoadRegionPlugin: Region constructor has been changed to take options as an object.' );\n\t\t\toptions = { errorTarget: options };\n\n\t\t}\n\n\t\tconst {\n\t\t\terrorTarget = 10,\n\t\t\tmask = false,\n\t\t} = options;\n\n\t\tthis.errorTarget = errorTarget;\n\t\tthis.mask = mask;\n\n\t}\n\n\tintersectsTile( boundingVolume, tile, tiles ) {\n\n\t\treturn false;\n\n\t}\n\n\tcalculateDistance( boundingVolume, tile, tiles ) {\n\n\t\treturn Infinity;\n\n\t}\n\n\tcalculateError( tile, tilesRenderer ) {\n\n\t\treturn tile.geometricError - this.errorTarget + tilesRenderer.errorTarget;\n\n\t}\n\n}\n\nexport class SphereRegion extends BaseRegion {\n\n\tconstructor( options = {} ) {\n\n\t\tif ( typeof options === 'number' ) {\n\n\t\t\tconsole.warn( 'SphereRegion: Region constructor has been changed to take options as an object.' );\n\t\t\toptions = {\n\t\t\t\terrorTarget: arguments[ 0 ],\n\t\t\t\tsphere: arguments[ 1 ],\n\t\t\t};\n\n\t\t}\n\n\t\tconst { sphere = new Sphere() } = options;\n\n\t\tsuper( options );\n\t\tthis.sphere = sphere.clone();\n\n\t}\n\n\tintersectsTile( boundingVolume ) {\n\n\t\treturn boundingVolume.intersectsSphere( this.sphere );\n\n\t}\n\n}\n\nexport class RayRegion extends BaseRegion {\n\n\tconstructor( options = {} ) {\n\n\t\tif ( typeof options === 'number' ) {\n\n\t\t\tconsole.warn( 'RayRegion: Region constructor has been changed to take options as an object.' );\n\t\t\toptions = {\n\t\t\t\terrorTarget: arguments[ 0 ],\n\t\t\t\tray: arguments[ 1 ],\n\t\t\t};\n\n\t\t}\n\n\t\tconst { ray = new Ray() } = options;\n\n\t\tsuper( options );\n\t\tthis.ray = ray.clone();\n\n\t}\n\n\tintersectsTile( boundingVolume ) {\n\n\t\treturn boundingVolume.intersectsRay( this.ray );\n\n\t}\n\n}\n\nexport class OBBRegion extends BaseRegion {\n\n\tconstructor( options = {} ) {\n\n\t\tif ( typeof options === 'number' ) {\n\n\t\t\tconsole.warn( 'RayRegion: Region constructor has been changed to take options as an object.' );\n\t\t\toptions = {\n\t\t\t\terrorTarget: arguments[ 0 ],\n\t\t\t\tobb: arguments[ 1 ],\n\t\t\t};\n\n\t\t}\n\n\t\tconst { obb = new OBB() } = options;\n\n\t\tsuper( options );\n\t\tthis.obb = obb.clone();\n\t\tthis.obb.update();\n\n\t}\n\n\tintersectsTile( boundingVolume ) {\n\n\t\treturn boundingVolume.intersectsOBB( this.obb );\n\n\t}\n\n}\n","import { EnvironmentControls, TilesRenderer } from '3d-tiles-renderer';\nimport {\n\tDebugTilesPlugin,\n\tLoadRegionPlugin,\n\tRayRegion,\n\tOBBRegion,\n\tSphereRegion,\n} from '3d-tiles-renderer/plugins';\nimport {\n\tScene,\n\tWebGLRenderer,\n\tPerspectiveCamera,\n\tMesh,\n\tVector3,\n\tSphereGeometry,\n\tBoxGeometry,\n\tClock,\n\tLine,\n} from 'three';\nimport { GUI } from 'three/examples/jsm/libs/lil-gui.module.min.js';\n\nlet camera, controls, scene, renderer, tiles;\nlet rayRegion, sphereRegion, boxRegion;\nlet sphereMesh, rayMesh, boxMesh;\nlet clock, time = 0;\n\nconst params = {\n\n\tanimate: true,\n\tregion: 'SPHERE',\n\tregionErrorTarget: 0.1,\n\tregionOnly: true,\n\tmask: false,\n\tdisplayBoxBounds: false,\n\n};\n\ninit();\nanimate();\n\nfunction init() {\n\n\tscene = new Scene();\n\n\t// primary camera view\n\trenderer = new WebGLRenderer( { antialias: true } );\n\trenderer.setPixelRatio( window.devicePixelRatio );\n\trenderer.setSize( window.innerWidth, window.innerHeight );\n\trenderer.setClearColor( 0x151c1f );\n\n\tdocument.body.appendChild( renderer.domElement );\n\trenderer.domElement.tabIndex = 1;\n\n\t// update the camera\n\tcamera = new PerspectiveCamera(\n\t\t60,\n\t\twindow.innerWidth / window.innerHeight,\n\t\t1,\n\t\t100000\n\t);\n\tcamera.position.set( 100, 100, 100 );\n\tcamera.lookAt( 0, 0, 0 );\n\tscene.add( camera );\n\n\t// clock\n\tclock = new Clock();\n\n\t// init tiles\n\ttiles = new TilesRenderer( 'https://raw.githubusercontent.com/NASA-AMMOS/3DTilesSampleData/master/msl-dingo-gap/0528_0260184_to_s64o256_colorize/0528_0260184_to_s64o256_colorize/0528_0260184_to_s64o256_colorize_tileset.json' );\n\ttiles.registerPlugin( new DebugTilesPlugin() );\n\ttiles.registerPlugin( new LoadRegionPlugin() );\n\ttiles.group.rotation.x = Math.PI / 2;\n\tscene.add( tiles.group );\n\n\t// controls\n\tcontrols = new EnvironmentControls( tiles.group, camera, renderer.domElement );\n\tcontrols.enableDamping = true;\n\n\t// initialize regions\n\trayRegion = new RayRegion();\n\tsphereRegion = new SphereRegion();\n\tsphereRegion.sphere.radius = 15;\n\tboxRegion = new OBBRegion();\n\tboxRegion.obb.box.min = new Vector3( - 50, - 50, - 5 );\n\tboxRegion.obb.box.max = new Vector3( 50, 50, 5 );\n\n\t// initialize region meshes\n\tsphereMesh = new Mesh( new SphereGeometry() );\n\tsphereMesh.material.transparent = true;\n\tsphereMesh.material.opacity = 0.25;\n\n\tboxMesh = new Mesh( new BoxGeometry() );\n\tboxMesh.material.transparent = true;\n\tboxMesh.material.opacity = 0.25;\n\n\trayMesh = new Line();\n\trayMesh.geometry.setFromPoints( [ new Vector3(), new Vector3( 0, - 1000, 0 ) ] );\n\trayMesh.material.opacity = 0.5;\n\trayMesh.material.transparent = true;\n\n\t// update the region to display\n\tupdateRegion( params.region );\n\n\t// update camera parameters\n\tonWindowResize();\n\twindow.addEventListener( 'resize', onWindowResize, false );\n\n\t// GUI\n\tconst gui = new GUI();\n\tgui.width = 300;\n\tgui.add( params, 'region', [ 'SPHERE', 'BOX', 'RAY' ] ).onChange( updateRegion );\n\tgui.add( params, 'regionErrorTarget' ).min( 0 ).max( 1 );\n\tgui.add( params, 'animate' );\n\tgui.add( params, 'mask' );\n\tgui.add( params, 'regionOnly' ).onChange( v => {\n\n\t\tif ( ! v ) {\n\n\t\t\ttiles.setCamera( camera );\n\t\t\tonWindowResize();\n\n\t\t} else {\n\n\t\t\ttiles.deleteCamera( camera );\n\n\t\t}\n\n\t} );\n\tgui.add( params, 'displayBoxBounds' );\n\n\tgui.open();\n\n}\n\nfunction onWindowResize() {\n\n\tcamera.aspect = window.innerWidth / window.innerHeight;\n\trenderer.setSize( window.innerWidth, window.innerHeight );\n\tcamera.updateProjectionMatrix();\n\trenderer.setPixelRatio( window.devicePixelRatio * 1 );\n\ttiles.setResolutionFromRenderer( camera, renderer );\n\n}\n\nfunction updateRegion( region ) {\n\n\tconst plugin = tiles.getPluginByName( 'LOAD_REGION_PLUGIN' );\n\tplugin.clearRegions();\n\tscene.remove( rayMesh, sphereMesh, boxMesh );\n\n\tif ( region === 'SPHERE' ) {\n\n\t\tplugin.addRegion( sphereRegion );\n\t\tscene.add( sphereMesh );\n\n\t} else if ( region === 'RAY' ) {\n\n\t\tplugin.addRegion( rayRegion );\n\t\tscene.add( rayMesh );\n\n\t} else if ( region === 'BOX' ) {\n\n\t\tplugin.addRegion( boxRegion );\n\t\tscene.add( boxMesh );\n\n\t}\n\n}\n\n\nfunction animate() {\n\n\trequestAnimationFrame( animate );\n\n\t// update time step\n\tif ( params.animate ) {\n\n\t\ttime += clock.getDelta();\n\n\t} else {\n\n\t\tclock.getDelta();\n\n\t}\n\n\t// update debug plugin\n\tconst debugPlugin = tiles.getPluginByName( 'DEBUG_TILES_PLUGIN' );\n\tdebugPlugin.enabled = params.displayBoxBounds;\n\tdebugPlugin.displayBoxBounds = params.displayBoxBounds;\n\n\t// update the regions\n\tif ( params.region === 'SPHERE' ) {\n\n\t\tsphereMesh.position.set( Math.sin( time ) * 20, 0, Math.cos( time ) * 20 );\n\t\tsphereMesh.scale.setScalar( sphereRegion.sphere.radius );\n\n\t\tsphereRegion.mask = params.mask;\n\t\tsphereRegion.errorTarget = params.mask ? Infinity : params.regionErrorTarget;\n\t\tsphereRegion.sphere.center\n\t\t\t.copy( sphereMesh.position )\n\t\t\t.applyMatrix4( tiles.group.matrixWorldInverse );\n\n\t} else if ( params.region === 'RAY' ) {\n\n\t\trayMesh.position.set( Math.sin( time * 2 ) * 20, 50, Math.cos( time * 2 ) * 20 );\n\n\t\trayRegion.mask = params.mask;\n\t\trayRegion.errorTarget = params.mask ? Infinity : params.regionErrorTarget;\n\t\trayRegion.ray.direction\n\t\t\t.set( 0, - 1, 0 )\n\t\t\t.transformDirection( tiles.group.matrixWorldInverse );\n\t\trayRegion.ray.origin\n\t\t\t.copy( rayMesh.position )\n\t\t\t.applyMatrix4( tiles.group.matrixWorldInverse );\n\n\t} else if ( params.region === 'BOX' ) {\n\n\t\tboxMesh.scale.set( 50, 10, 50 );\n\t\tboxMesh.rotation.y = time;\n\t\tboxMesh.updateMatrixWorld();\n\t\tboxMesh.geometry.computeBoundingBox();\n\n\t\tboxRegion.mask = params.mask;\n\t\tboxRegion.errorTarget = params.mask ? Infinity : params.regionErrorTarget;\n\t\tboxRegion.obb.box.copy( boxMesh.geometry.boundingBox );\n\t\tboxRegion.obb.transform.copy( boxMesh.matrixWorld ).premultiply( tiles.group.matrixWorldInverse );\n\t\tboxRegion.obb.update();\n\n\t}\n\n\t// update tiles\n\tcontrols.update();\n\tcamera.updateMatrixWorld();\n\ttiles.update();\n\n\t// render\n\trenderer.render( scene, camera );\n\n}\n"],"names":["LoadRegionPlugin","tiles","region","index","tile","target","boundingVolume","regions","inShape","inMask","maxError","minDistance","intersects","BaseRegion","options","errorTarget","mask","tilesRenderer","SphereRegion","sphere","Sphere","RayRegion","ray","Ray","OBBRegion","obb","OBB","camera","controls","scene","renderer","rayRegion","sphereRegion","boxRegion","sphereMesh","rayMesh","boxMesh","clock","time","params","init","animate","Scene","WebGLRenderer","PerspectiveCamera","Clock","TilesRenderer","DebugTilesPlugin","EnvironmentControls","Vector3","Mesh","SphereGeometry","BoxGeometry","Line","updateRegion","onWindowResize","gui","GUI","v","plugin","debugPlugin"],"mappings":"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"}