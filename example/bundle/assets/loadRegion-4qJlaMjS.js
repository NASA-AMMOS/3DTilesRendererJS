import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css               */import{O as D,T as W}from"./TilesRenderer-Bm042Xsy.js";import{E as v}from"./EnvironmentControls-BRF5UI-K.js";import{ah as L,d as A,S as C,W as G,a as H,o as f,h as S,i as N,k as V,ai as z,u as j}from"./three.module-D-uF--xd.js";import{D as U}from"./DebugTilesPlugin-DPW5Pin-.js";import{g as F}from"./lil-gui.module.min-BH_YJbPT.js";import"./TilesRendererBase-CFsQu8zV.js";import"./constants-JFoaxC9y.js";import"./BatchTable-CRr3zuRk.js";import"./B3DMLoader-Cnf0ja_2.js";import"./B3DMLoaderBase-w5mdSgm-.js";import"./GLTFLoader-B4GrkiON.js";import"./PNTSLoader-DwvZQNdL.js";import"./I3DMLoader-BWluRuWb.js";import"./Ellipsoid-Dwquuq5w.js";import"./CMPTLoader-BOTrymv0.js";import"./EllipsoidRegion-VNvPMw5b.js";import"./EllipsoidRegionHelper-CAg2B1Y_.js";class X{constructor(){this.name="LOAD_REGION_PLUGIN",this.regions=[],this.tiles=null}init(e){this.tiles=e}addRegion(e){this.regions.indexOf(e)===-1&&this.regions.push(e)}removeRegion(e){const t=this.regions.indexOf(e);t!==-1&&this.regions.splice(t,1)}hasRegion(e){return this.regions.indexOf(e)!==-1}clearRegions(){this.regions=[]}calculateTileViewError(e,t){const u=e.engineData.boundingVolume,{regions:O,tiles:y}=this;let R=!1,w=null,x=0,E=1/0;for(const b of O){const B=b.intersectsTile(u,e,y);R=R||B,B&&(x=Math.max(b.calculateError(e,y),x),E=Math.min(b.calculateDistance(u,e,y),E)),b.mask&&(w=w||B)}return t.inView=R&&w!==!1,t.error=x,t.distance=E,t.inView||w!==null}dispose(){this.regions=[]}}class M{constructor(e={}){typeof e=="number"&&(console.warn("LoadRegionPlugin: Region constructor has been changed to take options as an object."),e={errorTarget:e});const{errorTarget:t=10,mask:u=!1}=e;this.errorTarget=t,this.mask=u}intersectsTile(e,t,u){return!1}calculateDistance(e,t,u){return 1/0}calculateError(e,t){return e.geometricError-this.errorTarget+t.errorTarget}}class Y extends M{constructor(e={}){typeof e=="number"&&(console.warn("SphereRegion: Region constructor has been changed to take options as an object."),e={errorTarget:arguments[0],sphere:arguments[1]});const{sphere:t=new A}=e;super(e),this.sphere=t.clone()}intersectsTile(e){return e.intersectsSphere(this.sphere)}}class q extends M{constructor(e={}){typeof e=="number"&&(console.warn("RayRegion: Region constructor has been changed to take options as an object."),e={errorTarget:arguments[0],ray:arguments[1]});const{ray:t=new L}=e;super(e),this.ray=t.clone()}intersectsTile(e){return e.intersectsRay(this.ray)}}class J extends M{constructor(e={}){typeof e=="number"&&(console.warn("RayRegion: Region constructor has been changed to take options as an object."),e={errorTarget:arguments[0],obb:arguments[1]});const{obb:t=new D}=e;super(e),this.obb=t.clone(),this.obb.update()}intersectsTile(e){return e.intersectsOBB(this.obb)}}let o,k,c,a,i,h,m,l,g,d,s,P,p=0;const r={animate:!0,region:"SPHERE",regionErrorTarget:.1,regionOnly:!0,mask:!1,displayBoxBounds:!1};K();I();function K(){c=new C,a=new G({antialias:!0}),a.setPixelRatio(window.devicePixelRatio),a.setSize(window.innerWidth,window.innerHeight),a.setClearColor(1383455),document.body.appendChild(a.domElement),a.domElement.tabIndex=1,o=new H(60,window.innerWidth/window.innerHeight,1,1e5),o.position.set(100,100,100),o.lookAt(0,0,0),c.add(o),P=new j,i=new W("https://raw.githubusercontent.com/NASA-AMMOS/3DTilesSampleData/master/msl-dingo-gap/0528_0260184_to_s64o256_colorize/0528_0260184_to_s64o256_colorize/0528_0260184_to_s64o256_colorize_tileset.json"),i.registerPlugin(new U),i.registerPlugin(new X),i.group.rotation.x=Math.PI/2,c.add(i.group),k=new v(i.group,o,a.domElement),k.enableDamping=!0,h=new q,m=new Y,m.sphere.radius=15,l=new J,l.obb.box.min=new f(-50,-50,-5),l.obb.box.max=new f(50,50,5),g=new S(new N),g.material.transparent=!0,g.material.opacity=.25,s=new S(new V),s.material.transparent=!0,s.material.opacity=.25,d=new z,d.geometry.setFromPoints([new f,new f(0,-1e3,0)]),d.material.opacity=.5,d.material.transparent=!0,_(r.region),T(),window.addEventListener("resize",T,!1);const n=new F;n.width=300,n.add(r,"region",["SPHERE","BOX","RAY"]).onChange(_),n.add(r,"regionErrorTarget").min(0).max(1),n.add(r,"animate"),n.add(r,"mask"),n.add(r,"regionOnly").onChange(e=>{e?i.deleteCamera(o):(i.setCamera(o),T())}),n.add(r,"displayBoxBounds"),n.open()}function T(){o.aspect=window.innerWidth/window.innerHeight,a.setSize(window.innerWidth,window.innerHeight),o.updateProjectionMatrix(),a.setPixelRatio(window.devicePixelRatio*1),i.setResolutionFromRenderer(o,a)}function _(n){const e=i.getPluginByName("LOAD_REGION_PLUGIN");e.clearRegions(),c.remove(d,g,s),n==="SPHERE"?(e.addRegion(m),c.add(g)):n==="RAY"?(e.addRegion(h),c.add(d)):n==="BOX"&&(e.addRegion(l),c.add(s))}function I(){requestAnimationFrame(I),r.animate?p+=P.getDelta():P.getDelta();const n=i.getPluginByName("DEBUG_TILES_PLUGIN");n.enabled=r.displayBoxBounds,n.displayBoxBounds=r.displayBoxBounds,r.region==="SPHERE"?(g.position.set(Math.sin(p)*20,0,Math.cos(p)*20),g.scale.setScalar(m.sphere.radius),m.mask=r.mask,m.errorTarget=r.mask?1/0:r.regionErrorTarget,m.sphere.center.copy(g.position).applyMatrix4(i.group.matrixWorldInverse)):r.region==="RAY"?(d.position.set(Math.sin(p*2)*20,50,Math.cos(p*2)*20),h.mask=r.mask,h.errorTarget=r.mask?1/0:r.regionErrorTarget,h.ray.direction.set(0,-1,0).transformDirection(i.group.matrixWorldInverse),h.ray.origin.copy(d.position).applyMatrix4(i.group.matrixWorldInverse)):r.region==="BOX"&&(s.scale.set(50,10,50),s.rotation.y=p,s.updateMatrixWorld(),s.geometry.computeBoundingBox(),l.mask=r.mask,l.errorTarget=r.mask?1/0:r.regionErrorTarget,l.obb.box.copy(s.geometry.boundingBox),l.obb.transform.copy(s.matrixWorld).premultiply(i.group.matrixWorldInverse),l.obb.update()),k.update(),o.updateMatrixWorld(),i.update(),a.render(c,o)}
//# sourceMappingURL=loadRegion-4qJlaMjS.js.map
