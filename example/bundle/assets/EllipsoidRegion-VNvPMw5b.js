import{o as S,n as q,B as _}from"./three.module-D-uF--xd.js";import{E as I}from"./Ellipsoid-Dwquuq5w.js";const z=1e-13,E=Math.PI,f=E/2,C=new S,P=new S,g=new S,t=new S,n=new q,v=new _,w=new q;function u(T,i){i.radius=Math.max(i.radius,T.distanceToSquared(i.center))}function B(T){return T.x!==T.y}class A extends I{constructor(i=1,s=1,r=1,o=-f,l=f,M=0,e=2*E,a=0,p=0){super(i,s,r),this.latStart=o,this.latEnd=l,this.lonStart=M,this.lonEnd=e,this.heightStart=a,this.heightEnd=p}getBoundingBox(i,s){B(this.radius)&&console.warn("EllipsoidRegion: Triaxial ellipsoids are not supported.");const{latStart:r,latEnd:o,lonStart:l,lonEnd:M,heightStart:e,heightEnd:a}=this,p=(r+o)*.5,d=(l+M)*.5,m=r>0,y=o<0;let x;m?x=r:y?x=o:x=0;const{min:h,max:c}=i;h.setScalar(1/0),c.setScalar(-1/0),M-l<=E?(this.getCartographicToNormal(p,d,g),P.set(0,0,1),C.crossVectors(P,g).normalize(),P.crossVectors(g,C).normalize(),s.makeBasis(C,P,g),n.copy(s).invert(),this.getCartographicToPosition(x,l,a,t).applyMatrix4(n),c.x=Math.abs(t.x),h.x=-c.x,this.getCartographicToPosition(o,l,a,t).applyMatrix4(n),c.y=t.y,this.getCartographicToPosition(o,d,a,t).applyMatrix4(n),c.y=Math.max(t.y,c.y),this.getCartographicToPosition(r,l,a,t).applyMatrix4(n),h.y=t.y,this.getCartographicToPosition(r,d,a,t).applyMatrix4(n),h.y=Math.min(t.y,h.y),this.getCartographicToPosition(p,d,a,t).applyMatrix4(n),c.z=t.z,this.getCartographicToPosition(r,l,e,t).applyMatrix4(n),h.z=t.z,this.getCartographicToPosition(o,l,e,t).applyMatrix4(n),h.z=Math.min(t.z,h.z)):(this.getCartographicToPosition(x,d,a,g),g.z=0,g.length()<1e-10?g.set(1,0,0):g.normalize(),P.set(0,0,1),C.crossVectors(g,P).normalize(),s.makeBasis(C,P,g),n.copy(s).invert(),this.getCartographicToPosition(x,d+f,a,t).applyMatrix4(n),c.x=Math.abs(t.x),h.x=-c.x,this.getCartographicToPosition(o,0,y?e:a,t).applyMatrix4(n),c.y=t.y,this.getCartographicToPosition(r,0,m?e:a,t).applyMatrix4(n),h.y=t.y,this.getCartographicToPosition(x,d,a,t).applyMatrix4(n),c.z=t.z,this.getCartographicToPosition(x,M,a,t).applyMatrix4(n),h.z=t.z),i.getCenter(t),i.min.sub(t).multiplyScalar(1+z),i.max.sub(t).multiplyScalar(1+z),t.applyMatrix4(s),s.setPosition(t)}getBoundingSphere(i){B(this.radius)&&console.warn("EllipsoidRegion: Triaxial ellipsoids are not supported."),this.getBoundingBox(v,w),i.center.setFromMatrixPosition(w),i.radius=0;const{latStart:s,latEnd:r,lonStart:o,lonEnd:l,heightStart:M,heightEnd:e}=this,a=(s+r)*.5,p=(o+l)*.5,d=s>0,m=r<0;let y;d?y=s:m?y=r:y=0,this.getCartographicToPosition(y,o,e,t),u(t,i),this.getCartographicToPosition(r,o,e,t),u(t,i),this.getCartographicToPosition(r,p,e,t),u(t,i),this.getCartographicToPosition(s,o,e,t),u(t,i),this.getCartographicToPosition(s,p,e,t),u(t,i),this.getCartographicToPosition(a,p,e,t),u(t,i),this.getCartographicToPosition(s,o,M,t),u(t,i),l-o>E&&(this.getCartographicToPosition(y,p+E,e,t),u(t,i)),i.radius=Math.sqrt(i.radius)*(1+z)}}export{A as E};
//# sourceMappingURL=EllipsoidRegion-VNvPMw5b.js.map
