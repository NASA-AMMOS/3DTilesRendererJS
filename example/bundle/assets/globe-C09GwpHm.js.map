{"version":3,"file":"globe-C09GwpHm.js","sources":["../../r3f/globe.jsx"],"sourcesContent":["import { StrictMode, useRef } from 'react';\nimport { createRoot } from 'react-dom/client';\n\n// TilesRenderer, controls and attribution imports\nimport {\n\tTilesPlugin,\n\tTilesRenderer,\n\tTilesAttributionOverlay,\n\tGlobeControls,\n\tEastNorthUpFrame,\n\tCompassGizmo,\n} from '3d-tiles-renderer/r3f';\n\n// Plugins\nimport {\n\tCesiumIonAuthPlugin,\n\tUpdateOnChangePlugin,\n\tTileCompressionPlugin,\n\tTilesFadePlugin,\n\tGLTFExtensionsPlugin,\n} from '3d-tiles-renderer/plugins';\nimport { DRACOLoader } from 'three/examples/jsm/loaders/DRACOLoader.js';\n\n// R3F, DREI and LEVA imports\nimport { Canvas, useFrame } from '@react-three/fiber';\nimport { Environment } from '@react-three/drei';\nimport { useControls } from 'leva';\nimport { MathUtils, Vector3 } from 'three';\nimport { TilesLoadingBar } from './components/TilesLoadingBar.jsx';\nimport { CameraViewTransition } from './components/CameraViewTransition.jsx';\n\nconst dracoLoader = new DRACOLoader().setDecoderPath( 'https://www.gstatic.com/draco/v1/decoders/' );\nconst vec1 = new Vector3();\nconst vec2 = new Vector3();\n\nfunction Pointer() {\n\n\tconst ref = useRef();\n\tuseFrame( ( { camera } ) => {\n\n\t\tconst pointer = ref.current;\n\t\tvec1.setFromMatrixPosition( camera.matrixWorld );\n\n\t\tpointer.position.set( 0, 0, 0 );\n\t\tpointer.updateMatrixWorld();\n\t\tvec2.setFromMatrixPosition( pointer.matrixWorld );\n\n\t\tlet scale;\n\t\tif ( camera.isPerspectiveCamera ) {\n\n\t\t\tconst distance = vec1.distanceTo( vec2 );\n\t\t\tscale = Math.max( 0.05 * distance * Math.atan( camera.fov * MathUtils.DEG2RAD ), 25 );\n\n\t\t} else {\n\n\t\t\tscale = Math.max( ( camera.top - camera.bottom ) * 0.05 / camera.zoom, 25 );\n\n\t\t}\n\n\t\tpointer.scale.setScalar( scale );\n\t\tpointer.position.z = scale * 0.5;\n\n\t} );\n\n\treturn (\n\t\t<mesh ref={ ref } rotation-x={ - Math.PI / 2 } raycast={ () => {} }>\n\t\t\t<coneGeometry args={ [ 0.3 ] } />\n\t\t\t<meshStandardMaterial color={ 0xEC407A } emissive={ 0xEC407A } emissiveIntensity={ 0.25 } />\n\t\t</mesh>\n\t);\n\n}\n\nfunction App() {\n\n\tconst levaParams = {\n\t\tortho: false,\n\t};\n\n\t// TODO: the renderer is rerendering due to floating point issues\n\t// - see if we should trigger an invalidate on tiles plugin add and params change\n\t// - see if we need to trigger a force update on plugin add for the UpdateOnChange plugin\n\n\tconst { ortho } = useControls( levaParams );\n\treturn (\n\t\t<Canvas\n\t\t\tframeloop='demand'\n\t\t\tcamera={ {\n\t\t\t\tposition: [ 0, 0.5 * 1e7, 1.5 * 1e7 ],\n\t\t\t} }\n\t\t\tstyle={ {\n\t\t\t\twidth: '100%',\n\t\t\t\theight: '100%',\n\t\t\t\tposition: 'absolute',\n\t\t\t\tmargin: 0,\n\t\t\t\tleft: 0,\n\t\t\t\ttop: 0,\n\t\t\t} }\n\t\t\tflat\n\t\t>\n\t\t\t<color attach=\"background\" args={ [ 0x111111 ] } />\n\n\t\t\t<TilesRenderer group={ { rotation: [ - Math.PI / 2, 0, 0 ] } }>\n\t\t\t\t<TilesPlugin plugin={ CesiumIonAuthPlugin } args={ { apiToken: import.meta.env.VITE_ION_KEY, assetId: '2275207', autoRefreshToken: true } } />\n\t\t\t\t<TilesPlugin plugin={ GLTFExtensionsPlugin } dracoLoader={ dracoLoader } />\n\t\t\t\t<TilesPlugin plugin={ TileCompressionPlugin } />\n\t\t\t\t<TilesPlugin plugin={ UpdateOnChangePlugin } />\n\t\t\t\t<TilesPlugin plugin={ TilesFadePlugin } />\n\n\t\t\t\t{/* Controls */}\n\t\t\t\t<GlobeControls enableDamping={ true } />\n\t\t\t\t<CameraViewTransition mode={ ortho ? 'orthographic' : 'perspective' } />\n\n\t\t\t\t{/* Attributions */}\n\t\t\t\t<TilesAttributionOverlay />\n\n\t\t\t\t{/* Pointer to NASA JPL */}\n\t\t\t\t<EastNorthUpFrame lat={ 34.2013 * MathUtils.DEG2RAD } lon={ - 118.1714 * MathUtils.DEG2RAD } height={ 350 }>\n\t\t\t\t\t<Pointer />\n\t\t\t\t</EastNorthUpFrame>;\n\n\t\t\t\t{/* Add compass gizmo */}\n\t\t\t\t<CompassGizmo />\n\n\t\t\t\t<TilesLoadingBar />\n\t\t\t</TilesRenderer>\n\n\t\t\t{/* other r3f staging */}\n\t\t\t<Environment\n\t\t\t\tpreset=\"sunset\"\n\t\t\t\tbackgroundBlurriness={ 0.9 }\n\t\t\t\tenvironmentIntensity={ 1 }\n\t\t\t/>\n\t\t</Canvas>\n\t);\n\n}\n\ncreateRoot( document.getElementById( 'root' ) ).render(\n\t<StrictMode>\n\t\t<App />\n\t</StrictMode>,\n);\n\n"],"names":["dracoLoader","DRACOLoader","vec1","Vector3","vec2","Pointer","ref","useRef","useFrame","camera","pointer","scale","distance","MathUtils","jsxs","App","levaParams","ortho","useControls","Canvas","jsx","TilesRenderer","TilesPlugin","CesiumIonAuthPlugin","GLTFExtensionsPlugin","TileCompressionPlugin","UpdateOnChangePlugin","TilesFadePlugin","GlobeControls","CameraViewTransition","TilesAttributionOverlay","EastNorthUpFrame","CompassGizmo","TilesLoadingBar","Environment","createRoot","StrictMode"],"mappings":"+3CA+BA,MAAMA,EAAc,IAAIC,IAAc,eAAgB,4CAA6C,EAC7FC,EAAO,IAAIC,EACXC,EAAO,IAAID,EAEjB,SAASE,GAAU,CAElB,MAAMC,EAAMC,EAAAA,OAAA,EACZ,OAAAC,EAAU,CAAE,CAAE,OAAAC,KAAc,CAE3B,MAAMC,EAAUJ,EAAI,QACpBJ,EAAK,sBAAuBO,EAAO,WAAY,EAE/CC,EAAQ,SAAS,IAAK,EAAG,EAAG,CAAE,EAC9BA,EAAQ,kBAAA,EACRN,EAAK,sBAAuBM,EAAQ,WAAY,EAEhD,IAAIC,EACJ,GAAKF,EAAO,oBAAsB,CAEjC,MAAMG,EAAWV,EAAK,WAAYE,CAAK,EACvCO,EAAQ,KAAK,IAAK,IAAOC,EAAW,KAAK,KAAMH,EAAO,IAAMI,EAAU,OAAQ,EAAG,EAAG,CAErF,MAECF,EAAQ,KAAK,KAAOF,EAAO,IAAMA,EAAO,QAAW,IAAOA,EAAO,KAAM,EAAG,EAI3EC,EAAQ,MAAM,UAAWC,CAAM,EAC/BD,EAAQ,SAAS,EAAIC,EAAQ,EAE9B,CAAE,EAGDG,EAAAA,KAAC,QAAK,IAAAR,EAAY,aAAa,CAAE,KAAK,GAAK,EAAI,QAAU,IAAM,CAAC,EAC/D,SAAA,OAAC,eAAA,CAAa,KAAO,CAAE,EAAI,EAAI,QAC9B,uBAAA,CAAqB,MAAQ,SAAW,SAAW,SAAW,kBAAoB,GAAA,CAAO,CAAA,EAC3F,CAGF,CAEA,SAASS,GAAM,CAEd,MAAMC,EAAa,CAClB,MAAO,EAAA,EAOF,CAAE,MAAAC,CAAA,EAAUC,EAAaF,CAAW,EAC1C,OACCF,EAAAA,KAACK,EAAA,CACA,UAAU,SACV,OAAS,CACR,SAAU,CAAE,EAAG,GAAM,IAAK,IAAM,GAAI,CAAA,EAErC,MAAQ,CACP,MAAO,OACP,OAAQ,OACR,SAAU,WACV,OAAQ,EACR,KAAM,EACN,IAAK,CAAA,EAEN,KAAI,GAEJ,SAAA,CAAAC,EAAAA,IAAC,SAAM,OAAO,aAAa,KAAO,CAAE,OAAS,EAAI,EAEjDN,EAAAA,KAACO,EAAA,CAAc,MAAQ,CAAE,SAAU,CAAE,CAAE,KAAK,GAAK,EAAG,EAAG,CAAE,CAAA,EACxD,SAAA,CAAAD,EAAAA,IAACE,EAAA,CAAY,OAASC,EAAsB,KAAO,CAAE,SAAU,wLAA8B,QAAS,UAAW,iBAAkB,EAAA,EAAS,QAC3ID,EAAA,CAAY,OAASE,EAAuB,YAAAxB,EAA4B,EACzEoB,EAAAA,IAACE,EAAA,CAAY,OAASG,EAAwB,EAC9CL,EAAAA,IAACE,EAAA,CAAY,OAASI,EAAuB,EAC7CN,EAAAA,IAACE,EAAA,CAAY,OAASK,EAAkB,EAGxCP,EAAAA,IAACQ,EAAA,CAAc,cAAgB,GAAO,QACrCC,EAAA,CAAqB,KAAOZ,EAAQ,eAAiB,cAAgB,QAGrEa,EAAA,EAAwB,QAGxBC,EAAA,CAAiB,IAAM,QAAUlB,EAAU,QAAU,IAAM,UAAaA,EAAU,QAAU,OAAS,IACrG,SAAAO,EAAAA,IAACf,IAAQ,EACV,EAAmB,UAGlB2B,EAAA,EAAa,QAEbC,EAAA,CAAA,CAAgB,CAAA,EAClB,EAGAb,EAAAA,IAACc,EAAA,CACA,OAAO,SACP,qBAAuB,GACvB,qBAAuB,CAAA,CAAA,CACxB,CAAA,CAAA,CAIH,CAEAC,EAAAA,WAAY,SAAS,eAAgB,MAAO,CAAE,EAAE,OAC/Cf,EAAAA,IAACgB,EAAAA,WAAA,CACA,eAACrB,EAAA,CAAA,CAAI,CAAA,CACN,CACD"}