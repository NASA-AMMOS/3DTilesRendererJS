{"version":3,"file":"BatchTable-CRr3zuRk.js","sources":["../../../src/core/renderer/utilities/LoaderUtils.js","../../../src/core/renderer/loaders/LoaderBase.js","../../../src/core/renderer/utilities/FeatureTable.js","../../../src/core/renderer/utilities/BatchTableHierarchyExtension.js","../../../src/core/renderer/utilities/BatchTable.js"],"sourcesContent":["export function readMagicBytes( bufferOrDataView ) {\n\n\tif ( bufferOrDataView === null || bufferOrDataView.byteLength < 4 ) {\n\n\t\treturn '';\n\n\t}\n\n\tlet view;\n\tif ( bufferOrDataView instanceof DataView ) {\n\n\t\tview = bufferOrDataView;\n\n\t} else {\n\n\t\tview = new DataView( bufferOrDataView );\n\n\t}\n\n\tif ( String.fromCharCode( view.getUint8( 0 ) ) === '{' ) {\n\n\t\treturn null;\n\n\t}\n\n\tlet magicBytes = '';\n\tfor ( let i = 0; i < 4; i ++ ) {\n\n\t\tmagicBytes += String.fromCharCode( view.getUint8( i ) );\n\n\t}\n\n\treturn magicBytes;\n\n}\n\nconst utf8decoder = new TextDecoder();\nexport function arrayToString( array ) {\n\n\treturn utf8decoder.decode( array );\n\n}\n\n// Returns a working path with a trailing slash\nexport function getWorkingPath( url ) {\n\n\treturn url.replace( /[\\\\/][^\\\\/]+$/, '' ) + '/';\n\n}\n","import { getWorkingPath } from '../utilities/LoaderUtils.js';\n\nexport class LoaderBase {\n\n\tconstructor() {\n\n\t\tthis.fetchOptions = {};\n\t\tthis.workingPath = '';\n\n\t}\n\n\tload( ...args ) {\n\n\t\tconsole.warn( 'Loader: \"load\" function has been deprecated in favor of \"loadAsync\".' );\n\t\treturn this.loadAsync( ...args );\n\n\t}\n\n\tloadAsync( url ) {\n\n\t\treturn fetch( url, this.fetchOptions )\n\t\t\t.then( res => {\n\n\t\t\t\tif ( ! res.ok ) {\n\n\t\t\t\t\tthrow new Error( `Failed to load file \"${ url }\" with status ${ res.status } : ${ res.statusText }` );\n\n\t\t\t\t}\n\t\t\t\treturn res.arrayBuffer();\n\n\t\t\t} )\n\t\t\t.then( buffer => {\n\n\t\t\t\tif ( this.workingPath === '' ) {\n\n\t\t\t\t\tthis.workingPath = getWorkingPath( url );\n\n\t\t\t\t}\n\n\t\t\t\treturn this.parse( buffer );\n\n\t\t\t} );\n\n\t}\n\n\tresolveExternalURL( url ) {\n\n\t\treturn new URL( url, this.workingPath ).href;\n\n\t}\n\n\tparse( buffer ) {\n\n\t\tthrow new Error( 'LoaderBase: Parse not implemented.' );\n\n\t}\n\n}\n","import { arrayToString } from './LoaderUtils.js';\n\nexport function parseBinArray( buffer, arrayStart, count, type, componentType, propertyName ) {\n\n\tlet stride;\n\tswitch ( type ) {\n\n\t\tcase 'SCALAR':\n\t\t\tstride = 1;\n\t\t\tbreak;\n\n\t\tcase 'VEC2':\n\t\t\tstride = 2;\n\t\t\tbreak;\n\n\t\tcase 'VEC3':\n\t\t\tstride = 3;\n\t\t\tbreak;\n\n\t\tcase 'VEC4':\n\t\t\tstride = 4;\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tthrow new Error( `FeatureTable : Feature type not provided for \"${ propertyName }\".` );\n\n\t}\n\n\tlet data;\n\tconst arrayLength = count * stride;\n\n\tswitch ( componentType ) {\n\n\t\tcase 'BYTE':\n\t\t\tdata = new Int8Array( buffer, arrayStart, arrayLength );\n\t\t\tbreak;\n\n\t\tcase 'UNSIGNED_BYTE':\n\t\t\tdata = new Uint8Array( buffer, arrayStart, arrayLength );\n\t\t\tbreak;\n\n\t\tcase 'SHORT':\n\t\t\tdata = new Int16Array( buffer, arrayStart, arrayLength );\n\t\t\tbreak;\n\n\t\tcase 'UNSIGNED_SHORT':\n\t\t\tdata = new Uint16Array( buffer, arrayStart, arrayLength );\n\t\t\tbreak;\n\n\t\tcase 'INT':\n\t\t\tdata = new Int32Array( buffer, arrayStart, arrayLength );\n\t\t\tbreak;\n\n\t\tcase 'UNSIGNED_INT':\n\t\t\tdata = new Uint32Array( buffer, arrayStart, arrayLength );\n\t\t\tbreak;\n\n\t\tcase 'FLOAT':\n\t\t\tdata = new Float32Array( buffer, arrayStart, arrayLength );\n\t\t\tbreak;\n\n\t\tcase 'DOUBLE':\n\t\t\tdata = new Float64Array( buffer, arrayStart, arrayLength );\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tthrow new Error( `FeatureTable : Feature component type not provided for \"${ propertyName }\".` );\n\n\t}\n\n\treturn data;\n\n}\n\nexport class FeatureTable {\n\n\tconstructor( buffer, start, headerLength, binLength ) {\n\n\t\tthis.buffer = buffer;\n\t\tthis.binOffset = start + headerLength;\n\t\tthis.binLength = binLength;\n\n\t\tlet header = null;\n\t\tif ( headerLength !== 0 ) {\n\n\t\t\tconst headerData = new Uint8Array( buffer, start, headerLength );\n\t\t\theader = JSON.parse( arrayToString( headerData ) );\n\n\t\t} else {\n\n\t\t\theader = {};\n\n\t\t}\n\t\tthis.header = header;\n\n\t}\n\n\tgetKeys() {\n\n\t\treturn Object.keys( this.header ).filter( key => key !== 'extensions' );\n\n\t}\n\n\tgetData( key, count, defaultComponentType = null, defaultType = null ) {\n\n\t\tconst header = this.header;\n\n\t\tif ( ! ( key in header ) ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst feature = header[ key ];\n\t\tif ( ! ( feature instanceof Object ) ) {\n\n\t\t\treturn feature;\n\n\t\t} else if ( Array.isArray( feature ) ) {\n\n\t\t\treturn feature;\n\n\t\t} else {\n\n\t\t\tconst { buffer, binOffset, binLength } = this;\n\t\t\tconst byteOffset = feature.byteOffset || 0;\n\t\t\tconst featureType = feature.type || defaultType;\n\t\t\tconst featureComponentType = feature.componentType || defaultComponentType;\n\n\t\t\tif ( 'type' in feature && defaultType && feature.type !== defaultType ) {\n\n\t\t\t\tthrow new Error( 'FeatureTable: Specified type does not match expected type.' );\n\n\t\t\t}\n\n\t\t\tconst arrayStart = binOffset + byteOffset;\n\t\t\tconst data = parseBinArray( buffer, arrayStart, count, featureType, featureComponentType, key );\n\n\t\t\tconst dataEnd = arrayStart + data.byteLength;\n\t\t\tif ( dataEnd > binOffset + binLength ) {\n\n\t\t\t\tthrow new Error( 'FeatureTable: Feature data read outside binary body length.' );\n\n\t\t\t}\n\n\t\t\treturn data;\n\n\t\t}\n\n\t}\n\n\tgetBuffer( byteOffset, byteLength ) {\n\n\t\tconst { buffer, binOffset } = this;\n\t\treturn buffer.slice( binOffset + byteOffset, binOffset + byteOffset + byteLength );\n\n\t}\n\n}\n","import { parseBinArray } from './FeatureTable.js';\n\nexport class BatchTableHierarchyExtension {\n\n\tconstructor( batchTable ) {\n\n\t\tthis.batchTable = batchTable;\n\n\t\tconst extensionHeader = batchTable.header.extensions[ '3DTILES_batch_table_hierarchy' ];\n\n\t\tthis.classes = extensionHeader.classes;\n\t\tfor ( const classDef of this.classes ) {\n\n\t\t\tconst instances = classDef.instances;\n\t\t\tfor ( const property in instances ) {\n\n\t\t\t\tclassDef.instances[ property ] = this._parseProperty( instances[ property ], classDef.length, property );\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.instancesLength = extensionHeader.instancesLength;\n\n\t\tthis.classIds = this._parseProperty( extensionHeader.classIds, this.instancesLength, 'classIds' );\n\n\t\tif ( extensionHeader.parentCounts ) {\n\n\t\t\tthis.parentCounts = this._parseProperty( extensionHeader.parentCounts, this.instancesLength, 'parentCounts' );\n\n\t\t} else {\n\n\t\t\tthis.parentCounts = new Array( this.instancesLength ).fill( 1 );\n\n\t\t}\n\n\t\tif ( extensionHeader.parentIds ) {\n\n\t\t\tconst parentIdsLength = this.parentCounts.reduce( ( a, b ) => a + b, 0 );\n\t\t\tthis.parentIds = this._parseProperty( extensionHeader.parentIds, parentIdsLength, 'parentIds' );\n\n\t\t} else {\n\n\t\t\tthis.parentIds = null;\n\n\t\t}\n\n\t\tthis.instancesIds = [];\n\t\tconst classCounter = {};\n\t\tfor ( const classId of this.classIds ) {\n\n\t\t\tclassCounter[ classId ] = classCounter[ classId ] ?? 0;\n\t\t\tthis.instancesIds.push( classCounter[ classId ] );\n\t\t\tclassCounter[ classId ] ++;\n\n\t\t}\n\n\t}\n\n\t_parseProperty( property, propertyLength, propertyName ) {\n\n\t\tif ( Array.isArray( property ) ) {\n\n\t\t\treturn property;\n\n\t\t} else {\n\n\t\t\tconst { buffer, binOffset } = this.batchTable;\n\n\t\t\tconst byteOffset = property.byteOffset;\n\t\t\tconst componentType = property.componentType || 'UNSIGNED_SHORT';\n\n\t\t\tconst arrayStart = binOffset + byteOffset;\n\n\t\t\treturn parseBinArray( buffer, arrayStart, propertyLength, 'SCALAR', componentType, propertyName );\n\n\t\t}\n\n\t}\n\n\tgetDataFromId( id, target = {} ) {\n\n\t\t// Get properties inherited from parents\n\n\t\tconst parentCount = this.parentCounts[ id ];\n\n\t\tif ( this.parentIds && parentCount > 0 ) {\n\n\t\t\tlet parentIdsOffset = 0;\n\t\t\tfor ( let i = 0; i < id; i ++ ) {\n\n\t\t\t\tparentIdsOffset += this.parentCounts[ i ];\n\n\t\t\t}\n\n\t\t\tfor ( let i = 0; i < parentCount; i ++ ) {\n\n\t\t\t\tconst parentId = this.parentIds[ parentIdsOffset + i ];\n\t\t\t\tif ( parentId !== id ) {\n\n\t\t\t\t\tthis.getDataFromId( parentId, target );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Get properties proper to this instance\n\n\t\tconst classId = this.classIds[ id ];\n\t\tconst instances = this.classes[ classId ].instances;\n\t\tconst className = this.classes[ classId ].name;\n\t\tconst instanceId = this.instancesIds[ id ];\n\n\t\tfor ( const key in instances ) {\n\n\t\t\ttarget[ className ] = target[ className ] || {};\n\t\t\ttarget[ className ][ key ] = instances[ key ][ instanceId ];\n\n\t\t}\n\n\t\treturn target;\n\n\t}\n\n}\n","import { BatchTableHierarchyExtension } from './BatchTableHierarchyExtension.js';\nimport { FeatureTable } from './FeatureTable.js';\n\nexport class BatchTable extends FeatureTable {\n\n\tget batchSize() {\n\n\t\tconsole.warn( 'BatchTable.batchSize has been deprecated and replaced with BatchTable.count.' );\n\t\treturn this.count;\n\n\t}\n\n\tconstructor( buffer, count, start, headerLength, binLength ) {\n\n\t\tsuper( buffer, start, headerLength, binLength );\n\t\tthis.count = count;\n\n\t\tthis.extensions = {};\n\t\tconst extensions = this.header.extensions;\n\t\tif ( extensions ) {\n\n\t\t\tif ( extensions[ '3DTILES_batch_table_hierarchy' ] ) {\n\n\t\t\t\tthis.extensions[ '3DTILES_batch_table_hierarchy' ] = new BatchTableHierarchyExtension( this );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tgetData( key, componentType = null, type = null ) {\n\n\t\tconsole.warn( 'BatchTable: BatchTable.getData is deprecated. Use BatchTable.getDataFromId to get all' +\n\t\t\t'properties for an id or BatchTable.getPropertyArray for getting an array of value for a property.' );\n\t\treturn super.getData( key, this.count, componentType, type );\n\n\t}\n\n\tgetDataFromId( id, target = {} ) {\n\n\t\tif ( id < 0 || id >= this.count ) {\n\n\t\t\tthrow new Error( `BatchTable: id value \"${ id }\" out of bounds for \"${ this.count }\" features number.` );\n\n\t\t}\n\n\t\tfor ( const key of this.getKeys() ) {\n\n\t\t\ttarget[ key ] = super.getData( key, this.count )[ id ];\n\n\t\t}\n\n\t\tfor ( const extensionName in this.extensions ) {\n\n\t\t\tconst extension = this.extensions[ extensionName ];\n\n\t\t\tif ( extension.getDataFromId instanceof Function ) {\n\n\t\t\t\ttarget[ extensionName ] = target[ extensionName ] || {};\n\t\t\t\textension.getDataFromId( id, target[ extensionName ] );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn target;\n\n\t}\n\n\tgetPropertyArray( key ) {\n\n\t\treturn super.getData( key, this.count );\n\n\t}\n\n\n}\n"],"names":["readMagicBytes","bufferOrDataView","view","magicBytes","i","utf8decoder","arrayToString","array","getWorkingPath","url","LoaderBase","args","res","buffer","parseBinArray","arrayStart","count","type","componentType","propertyName","stride","data","arrayLength","FeatureTable","start","headerLength","binLength","header","headerData","key","defaultComponentType","defaultType","feature","binOffset","byteOffset","featureType","featureComponentType","byteLength","BatchTableHierarchyExtension","batchTable","extensionHeader","classDef","instances","property","parentIdsLength","a","b","classCounter","classId","propertyLength","id","target","parentCount","parentIdsOffset","parentId","className","instanceId","BatchTable","extensions","extensionName","extension"],"mappings":"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"}