import{W as S,S as I,a as v,O as D}from"./three.module-DBfedTbk.js";/* empty css               */import{T}from"./TilesRenderer-UmkQDoLb.js";import{E as b}from"./EnvironmentControls-BBSDix_Q.js";import{C as R}from"./CameraTransitionManager-WDxKQLbX.js";import{U as y}from"./UpdateOnChangePlugin-CSUQNJGT.js";import{I as z}from"./ImageFormatPlugin-Cwk6ueKg.js";import{T as W}from"./TiledImageSource-DLt2EM25.js";import{g as E}from"./lil-gui.module.min-BH_YJbPT.js";import"./I3DMLoader-Co8j1K3i.js";import"./BatchTable-CRr3zuRk.js";import"./GLTFLoader-BjagHNWe.js";import"./Ellipsoid-CLPX16sm.js";import"./B3DMLoader-D_8ejTd0.js";import"./PNTSLoader-C47qgwy1.js";import"./CMPTLoader-CdR2x6K5.js";import"./EllipsoidRegion-By3sIuka.js";class A extends W{constructor(e={}){const{url:i=null,...s}=e;super(s),this.url=i,this.format=null,this.stem=null}getUrl(e,i,s){return`${this.stem}_files/${s}/${e}_${i}.${this.format}`}init(){const{url:e}=this;return this.fetchData(e,this.fetchOptions).then(i=>i.text()).then(i=>{const s=new DOMParser().parseFromString(i,"text/xml");if(s.querySelector("DisplayRects")||s.querySelector("Collection"))throw new Error("DeepZoomImagesPlugin: DisplayRect and Collection DZI files not supported.");const m=s.querySelector("Image"),d=m.querySelector("Size"),g=parseInt(d.getAttribute("Width")),u=parseInt(d.getAttribute("Height")),h=parseInt(m.getAttribute("TileSize")),f=parseInt(m.getAttribute("Overlap")),x=m.getAttribute("Format");this.format=x,this.stem=e.split(/\.[^.]+$/g)[0];const{tiling:p}=this,P=Math.ceil(Math.log2(Math.max(g,u)))+1;p.flipY=!0,p.pixelOverlap=f,p.generateLevels(P,1,1,{tilePixelWidth:h,tilePixelHeight:h,pixelWidth:g,pixelHeight:u})})}}class O extends z{constructor(e={}){const{url:i,...s}=e;super(s),this.name="DZI_TILES_PLUGIN",this.imageSource=new A({url:i})}}let n,l,o,t,r;const c={errorTarget:1,renderScale:1,orthographic:!1};H();C();function H(){o=new S({antialias:!0}),o.setPixelRatio(window.devicePixelRatio),o.setSize(window.innerWidth,window.innerHeight),o.setClearColor(1118481),document.body.appendChild(o.domElement),l=new I,r=new R(new v(60,window.innerWidth/window.innerHeight,.001,1e4),new D(-1,1,1,-1,0,4e3)),r.camera.position.set(0,0,150),r.camera.lookAt(0,0,0),r.autoSync=!1,r.addEventListener("camera-change",({camera:e,prevCamera:i})=>{t.deleteCamera(i),t.setCamera(e),n.setCamera(e)}),t=new T("https://openseadragon.github.io/example-images/duomo/duomo.dzi"),t.registerPlugin(new O({center:!0})),t.registerPlugin(new y),t.fetchOptions.mode="cors",t.lruCache.minSize=900,t.lruCache.maxSize=1300,t.errorTarget=1,t.setCamera(r.camera),l.add(t.group),n=new b(l,r.camera,o.domElement),n.minZoomDistance=2,n.minDistance=.01,n.maxDistance=1e3,n.cameraRadius=0,n.enableDamping=!0,n.fallbackPlane.normal.set(0,0,1),n.up.set(0,0,1),w(),window.addEventListener("resize",w,!1);const a=new E;a.add(c,"orthographic").onChange(e=>{r.fixedPoint.copy(n.pivotPoint),r.syncCameras(),n.adjustCamera(r.perspectiveCamera),n.adjustCamera(r.orthographicCamera),r.toggle()}),a.add(c,"errorTarget",0,100).onChange(()=>{t.getPluginByName("UPDATE_ON_CHANGE_PLUGIN").needsUpdate=!0}),a.add(c,"renderScale",.1,1,.05).onChange(e=>o.setPixelRatio(e*window.devicePixelRatio)),a.open()}function w(){const{perspectiveCamera:a,orthographicCamera:e}=r,i=window.innerWidth/window.innerHeight;e.bottom=-40,e.top=40,e.left=-40*i,e.right=40*i,e.updateProjectionMatrix(),a.aspect=i,a.updateProjectionMatrix(),o.setSize(window.innerWidth,window.innerHeight)}function C(){requestAnimationFrame(C),n.enabled=!r.animating,n.update(),r.update();const a=r.camera;a.updateMatrixWorld(),t.errorTarget=c.errorTarget,t.setCamera(a),t.setResolutionFromRenderer(a,o),t.update(),o.render(l,a)}
//# sourceMappingURL=deepZoom-C6SDjh5N.js.map
