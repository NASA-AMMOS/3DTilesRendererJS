import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css               */import{C as Z,E as N,A as T,O as Y,a as B,G as q,b as G,c as f,V as H,d as P,e as c,P as S,R as U,T as h,M as x,f as A,g as X,N as R,h as Q,Q as L,i as j,j as V,k as J,l as W,S as K,m as $,n as tt}from"./lil-gui.esm-B6p285Hr.js";import{C as et}from"./GoogleCloudAuth-vMnc9CC1.js";import"./TilesRendererBase-CFsQu8zV.js";import"./constants-JFoaxC9y.js";import"./BatchTable-CRr3zuRk.js";import"./B3DMLoaderBase-w5mdSgm-.js";import"./CesiumIonAuth-ByA9ya_o.js";class it{get name(){return"Interpolating"}get attachedNode(){return this._attachedCamera}constructor(){this.easingFunction=new Z,this.easingMode=N.EASINGMODE_EASEINOUT,this.transitionDuration=450,this._attachedCamera=null,this._animatables=new Map,this.easingFunction.setEasingMode(this.easingMode)}init(){}attach(t){this._attachedCamera=t}detach(){this._attachedCamera&&(this.stopAllAnimations(),this._attachedCamera=null)}get isInterpolating(){return this._animatables.size>0}stopAllAnimations(){var t;this._attachedCamera&&this._animatables.forEach(e=>e.stop()),this._animatables.clear(),(t=this._promiseResolve)==null||t.call(this),this._promiseResolve=void 0}updateProperties(t){t.forEach((e,i)=>{if(e!==void 0){const s=this._animatables.get(String(i));s&&(s.target=e)}})}async animatePropertiesAsync(t,e=this.transitionDuration,i=this.easingFunction,s){return await new Promise(r=>{if(this.stopAllAnimations(),this._promiseResolve=r,!this._attachedCamera)return this._promiseResolve=void 0,r();const o=this._attachedCamera,l=o.getScene(),d=u=>{for(let m=o.animations.length-1;m>=0;--m)o.animations[m].name===u+"Animation"&&o.animations.splice(m,1);this._animatables.delete(u),this._animatables.size===0&&(this._promiseResolve=void 0,r())};t.forEach((u,m)=>{if(u!==void 0&&o[m]!==u){const p=String(m),_=T.CreateAnimation(p,lt(u),60,i);s==null||s(p,_);const y=T.TransitionTo(p,u,o,l,60,_,e,()=>d(p),!1);y&&this._animatables.set(p,y)}})})}}function st(n){return n!=null&&typeof n.x=="number"&&typeof n.y=="number"&&typeof n.z=="number"&&typeof n.w=="number"}function nt(n){return n!=null&&(Array.isArray(n.m)||typeof n.m=="object")}function at(n){return n!=null&&typeof n.x=="number"&&typeof n.y=="number"&&typeof n.z=="number"}function ot(n){return n!=null&&typeof n.x=="number"&&typeof n.y=="number"}function rt(n){return n!=null&&typeof n.r=="number"&&typeof n.g=="number"&&typeof n.b=="number"}function ct(n){return n!=null&&typeof n.r=="number"&&typeof n.g=="number"&&typeof n.b=="number"&&typeof n.a=="number"}function ht(n){return n!=null&&typeof n.width=="number"&&typeof n.height=="number"}const lt=n=>st(n)?T.ANIMATIONTYPE_QUATERNION:nt(n)?T.ANIMATIONTYPE_MATRIX:at(n)?T.ANIMATIONTYPE_VECTOR3:ot(n)?T.ANIMATIONTYPE_VECTOR2:rt(n)?T.ANIMATIONTYPE_COLOR3:ct(n)?T.ANIMATIONTYPE_COLOR4:ht(n)?T.ANIMATIONTYPE_SIZE:T.ANIMATIONTYPE_FLOAT;class ut{constructor(){this._attachedCamera=null,this._onBeforeRenderObserver=null}get name(){return"GeospatialClipping"}get attachedNode(){return this._attachedCamera}init(){}attach(t){this._attachedCamera=t;const e=t.getScene();this._onBeforeRenderObserver=e.onBeforeRenderObservable.add(()=>{this._updateCameraClipPlanes()})}detach(){if(this._attachedCamera){const t=this._attachedCamera.getScene();this._onBeforeRenderObserver&&(t.onBeforeRenderObservable.remove(this._onBeforeRenderObserver),this._onBeforeRenderObserver=null)}this._attachedCamera=null}_updateCameraClipPlanes(){const t=this._attachedCamera;if(!t)return;const e=t.limits.planetRadius,i=Math.max(1,t.position.length()-e);t.minZ=Math.max(1,i*.001);const s=Math.sqrt(2*e*i+i*i);t.maxZ=s+e*.1}}class mt extends Y{constructor(){super(...arguments),this._initialPinchSquaredDistance=0,this._pinchCentroid=null}getClassName(){return"GeospatialCameraPointersInput"}onButtonDown(t){this.camera.movement.activeInput=!0;const e=this.camera.getScene();switch(t.button){case 0:this.camera.movement.startDrag(e.pointerX,e.pointerY);break}}onTouch(t,e,i){const s=(t==null?void 0:t.button)??0,a=this.camera.getScene();switch(s){case 0:this.camera.movement.handleDrag(a.pointerX,a.pointerY);break;case 1:case 2:this._handleTilt(e,i);break}}_computePinchZoom(t,e){const i=Math.sqrt(t),a=Math.sqrt(e)-i;if(this._pinchCentroid){const l=this.camera.getScene(),u=l.getEngine().getInputElementClientRect();if(u){const m=this._pinchCentroid.x-u.left,p=this._pinchCentroid.y-u.top,_=l.pick(m,p,this.camera.movement.pickPredicate);if(_!=null&&_.pickedPoint){const y=this.camera.position.subtract(_.pickedPoint).length(),C=a*y*.005,k=this.camera.limits.clampZoomDistance(C,this.camera.radius,y);this.camera.zoomToPoint(_.pickedPoint,k);return}}}const r=a*this.camera.radius*.005,o=this.camera.limits.clampZoomDistance(r,this.camera.radius);this.camera.zoomAlongLookAt(o)}_computeMultiTouchPanning(t,e){if(t&&e){const i=e.x-t.x,s=e.y-t.y;this._handleTilt(i,s)}}onDoubleTap(t){const e=this.camera._scene.pick(this.camera._scene.pointerX,this.camera._scene.pointerY,this.camera.movement.pickPredicate);e.pickedPoint&&this.camera.flyToPointAsync(e.pickedPoint)}onMultiTouch(t,e,i,s,a,r){if(this._pinchCentroid=r,s===0&&r===null){this._initialPinchSquaredDistance=0,this._pinchCentroid=null,super.onMultiTouch(t,e,i,s,a,r);return}this._initialPinchSquaredDistance===0&&s!==0&&(this._initialPinchSquaredDistance=s);const o=Math.abs(Math.sqrt(s)-Math.sqrt(this._initialPinchSquaredDistance));this._shouldStartPinchZoom=this._twoFingerActivityCount<20&&o>this.camera.limits.pinchToPanMax,super.onMultiTouch(t,e,i,s,a,r)}onButtonUp(t){this.camera.movement.stopDrag(),this.camera.movement.activeInput=!1,this._initialPinchSquaredDistance=0,this._pinchCentroid=null,super.onButtonUp(t)}onLostFocus(){this._initialPinchSquaredDistance=0,this._pinchCentroid=null,super.onLostFocus()}_handleTilt(t,e){this.camera.movement.rotationAccumulatedPixels.y-=t,this.camera.movement.rotationAccumulatedPixels.x-=e}}class dt extends B{constructor(t){super(t)}addMouse(){return this.add(new mt),this}addMouseWheel(){return this.add(new q),this}addKeyboard(){return this.add(new G),this}}class pt{constructor(t){this._radiusMin=10,this._radiusMax=1/0,this.pitchMin=f,this.pitchMax=Math.PI/2-.01,this.pitchDisabledRadiusScale=new H(2,4),this.yawMin=-1/0,this.yawMax=1/0,this.pinchToPanMax=20,this._planetRadius=t,this.radiusMax=t*4}get radiusMin(){return this._radiusMin}set radiusMin(t){this._radiusMin=t}get radiusMax(){return this._radiusMax}set radiusMax(t){this._radiusMax=t}get planetRadius(){return this._planetRadius}set planetRadius(t){this._planetRadius=t}clampZoomDistance(t,e,i){if(t>0){const s=(i??e)-this._radiusMin;return Math.min(t,Math.max(0,s))}else{const s=this._radiusMax-e;return Math.max(t,-Math.max(0,s))}}getEffectivePitchMax(t){if(!this.pitchDisabledRadiusScale)return this.pitchMax;const e=this.pitchDisabledRadiusScale.x*this._planetRadius,i=this.pitchDisabledRadiusScale.y*this._planetRadius;if(t<=e)return this.pitchMax;if(t>=i)return this.pitchMin;{const s=(t-e)/(i-e),a=P(s,0,1);return this.pitchMax*(1-a)+this.pitchMin*a}}}const O=1e3/60;class _t{constructor(t,e,i){this._cameraPosition=e,this._behavior=i,this.activeInput=!1,this.zoomSpeed=1,this.panSpeed=1,this.rotationXSpeed=1,this.rotationYSpeed=1,this._zoomSpeedMultiplier=1,this._panSpeedMultiplier=1,this.zoomInertia=.9,this.panInertia=.9,this.rotationInertia=.9,this.zoomAccumulatedPixels=0,this.panAccumulatedPixels=new c,this.rotationAccumulatedPixels=new c,this.zoomDeltaCurrentFrame=0,this.panDeltaCurrentFrame=c.Zero(),this.rotationDeltaCurrentFrame=c.Zero(),this._zoomVelocity=0,this._panVelocity=new c,this._rotationVelocity=new c,this._prevFrameTimeMs=O,this._scene=t}computeCurrentFrameDeltas(){var i;const t=this._scene.getEngine().getDeltaTime();this.panDeltaCurrentFrame.setAll(0),this.rotationDeltaCurrentFrame.setAll(0),this.zoomDeltaCurrentFrame=0,(this.panAccumulatedPixels.lengthSquared()>0||this.rotationAccumulatedPixels.lengthSquared()>0||this.zoomAccumulatedPixels!==0)&&((i=this._behavior)!=null&&i.isInterpolating)&&this._behavior.stopAllAnimations(),this._panVelocity.copyFromFloats(this._calculateCurrentVelocity(this._panVelocity.x,this.panAccumulatedPixels.x,this.panInertia),this._calculateCurrentVelocity(this._panVelocity.y,this.panAccumulatedPixels.y,this.panInertia),this._calculateCurrentVelocity(this._panVelocity.z,this.panAccumulatedPixels.z,this.panInertia)),this._panVelocity.scaleToRef(this.panSpeed*this._panSpeedMultiplier*t,this.panDeltaCurrentFrame),this._rotationVelocity.copyFromFloats(this._calculateCurrentVelocity(this._rotationVelocity.x,this.rotationAccumulatedPixels.x,this.rotationInertia),this._calculateCurrentVelocity(this._rotationVelocity.y,this.rotationAccumulatedPixels.y,this.rotationInertia),this._calculateCurrentVelocity(this._rotationVelocity.z,this.rotationAccumulatedPixels.z,this.rotationInertia)),this.rotationDeltaCurrentFrame.copyFromFloats(this._rotationVelocity.x*this.rotationXSpeed*t,this._rotationVelocity.y*this.rotationYSpeed*t,this._rotationVelocity.z*this.rotationYSpeed*t),this._zoomVelocity=this._calculateCurrentVelocity(this._zoomVelocity,this.zoomAccumulatedPixels,this.zoomInertia),this.zoomDeltaCurrentFrame=this._zoomVelocity*(this.zoomSpeed*this._zoomSpeedMultiplier)*t,this._prevFrameTimeMs=t,this.zoomAccumulatedPixels=0,this.panAccumulatedPixels.setAll(0),this.rotationAccumulatedPixels.setAll(0)}get isInterpolating(){var t;return!!((t=this._behavior)!=null&&t.isInterpolating)}_calculateCurrentVelocity(t,e,i){let s=t;const a=this._scene.getEngine().getDeltaTime();if(e!==0||this.activeInput)s=e/a;else if(!this.activeInput&&s!==0){const r=Math.pow(i,this._prevFrameTimeMs/O);s*=r,Math.abs(s)<=f&&(s=0)}return s}}class ft extends _t{constructor(t,e,i,s,a,r,o){super(t,i,o),this.limits=e,this._cameraCenter=s,this._cameraLookAt=a,this.zoomToCursor=!0,this._hitPointRadius=void 0,this._dragPlane=new S(0,0,0,0),this._dragPlaneNormal=c.Zero(),this._dragPlaneOriginPointEcef=c.Zero(),this._dragPlaneHitPointLocal=c.Zero(),this._previousDragPlaneHitPointLocal=c.Zero(),this.pickPredicate=r,this._tempPickingRay=new U(this._cameraPosition,this._cameraLookAt),this.panInertia=0,this.rotationInertia=0,this.rotationXSpeed=Math.PI/500,this.rotationYSpeed=Math.PI/500,this.zoomSpeed=2}startDrag(t,e){const i=this._scene.pick(t,e,this.pickPredicate);i.pickedPoint&&i.ray?(this._hitPointRadius=i.pickedPoint.length(),this._recalculateDragPlaneHitPoint(this._hitPointRadius,i.ray,h.Matrix[0]),this._previousDragPlaneHitPointLocal.copyFrom(this._dragPlaneHitPointLocal)):this._hitPointRadius=void 0}stopDrag(){this._hitPointRadius=void 0}_recalculateDragPlaneHitPoint(t,e,i){this._cameraPosition.normalizeToRef(this._dragPlaneNormal),this._dragPlaneNormal.scaleToRef(t,this._dragPlaneOriginPointEcef),F(this._dragPlaneOriginPointEcef,h.Vector3[0],h.Vector3[1],h.Vector3[2]);const s=x.FromXYZAxesToRef(h.Vector3[0],h.Vector3[1],h.Vector3[2],i);s.setTranslationFromFloats(this._dragPlaneOriginPointEcef.x,this._dragPlaneOriginPointEcef.y,this._dragPlaneOriginPointEcef.z);const a=s.invertToRef(h.Matrix[1]);S.FromPositionAndNormalToRef(this._dragPlaneOriginPointEcef,this._dragPlaneNormal,this._dragPlane),Pt(e,this._dragPlane,this._dragPlaneHitPointLocal)&&c.TransformCoordinatesToRef(this._dragPlaneHitPointLocal,a,this._dragPlaneHitPointLocal)}handleDrag(t,e){if(this._hitPointRadius){const i=this._scene.pick(t,e,this.pickPredicate);if(i.ray){const s=h.Matrix[0];this._recalculateDragPlaneHitPoint(this._hitPointRadius,i.ray,s);const a=this._dragPlaneHitPointLocal.subtractToRef(this._previousDragPlaneHitPointLocal,h.Vector3[6]),r=this._hitPointRadius*.1,o=a.length();o>r&&a.scaleInPlace(r/o),this._previousDragPlaneHitPointLocal.copyFrom(this._dragPlaneHitPointLocal),c.TransformNormalToRef(a,s,a),this._dragPlaneOriginPointEcef.addInPlace(a),this.panAccumulatedPixels.subtractInPlace(a)}}}computeCurrentFrameDeltas(){const t=this._cameraCenter;if(this.panAccumulatedPixels.lengthSquared()>f){const i=t.length(),s=this._cameraPosition.length(),a=i===0?0:t.z/i,r=Math.sqrt(1-Math.min(1,a*a)),o=Math.sqrt(Math.abs(r)),l=Math.max(s-i,f),d=Math.max(1,i/l);this._panSpeedMultiplier=P(d*o,0,1)}else this._panSpeedMultiplier=1;let e;this.isDragging||this.rotationAccumulatedPixels.lengthSquared()>f?(this._zoomSpeedMultiplier=0,this._zoomVelocity=0):(e=this.computedPerFrameZoomPickPoint?A(this._cameraPosition,this.computedPerFrameZoomPickPoint):void 0,this._zoomSpeedMultiplier=(e??A(this._cameraPosition,t))*.01),super.computeCurrentFrameDeltas()}get isDragging(){return this._hitPointRadius!==void 0}handleZoom(t,e){if(t!==0){this.zoomAccumulatedPixels+=t;const i=this._scene.pick(this._scene.pointerX,this._scene.pointerY,this.pickPredicate);if(e&&i.hit&&i.pickedPoint&&i.ray&&this.zoomToCursor)this.computedPerFrameZoomPickPoint=i.pickedPoint;else{const s=this.pickAlongVector(this._cameraLookAt);this.computedPerFrameZoomPickPoint=(s==null?void 0:s.pickedPoint)??void 0}}}pickAlongVector(t){return this._tempPickingRay.origin.copyFrom(this._cameraPosition),this._tempPickingRay.direction.copyFrom(t),this._scene.pickWithRay(this._tempPickingRay,this.pickPredicate)}}function yt(n){const t=.998749218,e=n.length();if(e>f){const i=e===0?0:n.z/e;if(Math.abs(i)>t){const s=P(i,-t,t),a=Math.sqrt(1-s*s),r=Math.atan2(n.y,n.x),o=e*Math.cos(r)*a,l=e*Math.sin(r)*a,d=e*s;n.set(o,l,d)}}return n}function Pt(n,t,e){const i=n.intersectsPlane(t);return i!==null&&i>=0?(n.origin.addToRef(n.direction.scaleToRef(i,h.Vector3[0]),e),!0):!1}function F(n,t,e,i){i.copyFrom(n).normalize();const s=c.LeftHandedForwardReadOnly;c.CrossToRef(s,i,t),t.lengthSquared()<f&&c.CrossToRef(c.Right(),i,t),t.normalize(),c.CrossToRef(i,t,e),e.normalize()}class gt extends X{constructor(t,e,i){super(t,new c,e),this._tempPosition=new c,this._tempCenter=new c,this._viewMatrix=new x,this._lookAtVector=new c,this._flyToTargets=new Map,this._collisionVelocity=new c,this.perFrameCollisionOffset=new c,this.checkCollisions=!1,this._center=new c,this._yaw=0,this._pitch=0,this._radius=0,this._tempVect=new c,this._tempEast=new c,this._tempNorth=new c,this._tempUp=new c,this._wasCenterMovingLastFrame=!1,this._limits=new pt(i.planetRadius),this._resetToDefault(this._limits),this._flyingBehavior=new it,this.addBehavior(this._flyingBehavior),this.movement=new ft(e,this._limits,this.position,this.center,this._lookAtVector,i.pickPredicate,this._flyingBehavior),this.inputs=new dt(this),this.inputs.addMouse().addMouseWheel().addKeyboard()}get center(){return this._center}set center(t){this._center.copyFromFloats(t.x,t.y,t.z),this._setOrientation(this._yaw,this._pitch,this._radius,this._center)}get yaw(){return this._yaw}set yaw(t){t!==this._yaw&&this._setOrientation(t,this.pitch,this.radius,this.center)}get pitch(){return this._pitch}set pitch(t){t!==this._pitch&&this._setOrientation(this.yaw,t,this.radius,this.center)}get radius(){return this._radius}set radius(t){t!==this._radius&&this._setOrientation(this.yaw,this.pitch,t,this.center)}_checkLimits(){const t=this.limits;this._yaw=P(this._yaw,t.yawMin,t.yawMax);const e=t.getEffectivePitchMax(this._radius);this._pitch=P(this._pitch,t.pitchMin,e),this._radius=P(this._radius,t.radiusMin,t.radiusMax),yt(this._center)}_setOrientation(t,e,i,s){this._yaw=R(t),this._pitch=R(e),this._radius=i,Q(s,this._center),this._checkLimits(),F(this._center,this._tempEast,this._tempNorth,this._tempUp),Tt(this._yaw,this._pitch,this._center,this._scene.useRightHandedSystem,this._lookAtVector);const a=h.Vector3[10];if(c.CrossToRef(this._tempUp,this._lookAtVector,a),a.lengthSquared()<f){const r=h.Vector3[11],o=this._scene.useRightHandedSystem?1:-1,l=h.Quaternion[1];L.RotationAxisToRef(this._tempUp,this._yaw*o,l),this._tempNorth.rotateByQuaternionToRef(l,r),c.CrossToRef(r,this._lookAtVector,a)}a.normalize(),c.CrossToRef(this._lookAtVector,a,this.upVector),this.upVector.normalize(),this._tempVect.copyFrom(this._lookAtVector).scaleInPlace(-this._radius),this._tempPosition.copyFrom(this._center).addInPlace(this._tempVect),this.checkCollisions&&(this.perFrameCollisionOffset=this._getCollisionOffset(this._tempPosition)),this._position.copyFrom(this._tempPosition),this._isViewMatrixDirty=!0}updateFlyToDestination(t,e,i,s){this._flyToTargets.clear();const a=t!==void 0?R(R(t)-this._yaw):0;this._flyToTargets.set("yaw",a===0?void 0:this._yaw+a),this._flyToTargets.set("pitch",e!=null?R(e):void 0),this._flyToTargets.set("radius",i),this._flyToTargets.set("center",s==null?void 0:s.clone()),this._flyingBehavior.updateProperties(this._flyToTargets)}async flyToAsync(t,e,i,s,a=1e3,r,o){this._flyToTargets.clear();const l=t!==void 0?R(R(t)-this._yaw):0;this._flyToTargets.set("yaw",l===0?void 0:this._yaw+l),this._flyToTargets.set("pitch",e!==void 0?R(e):void 0),this._flyToTargets.set("radius",i),this._flyToTargets.set("center",s==null?void 0:s.clone());let d;return s!==void 0&&!s.equals(this.center)&&(d=(u,m)=>{u==="center"&&(m.vector3InterpolateFunction=(p,_,y)=>{const C=c.SlerpToRef(p,_,y,this._tempCenter);if(o&&o>0){const z=o*A(p,_)*P((y*y-y)/-.25);C.scaleInPlace(1+z/C.length())}return C})}),await this._flyingBehavior.animatePropertiesAsync(this._flyToTargets,a,r,d)}async flyToPointAsync(t,e=.5,i=1e3,s,a){const r=A(this.position,t)*e,o=this._getCenterAndRadiusFromZoomToPoint(t,r,this._tempCenter);await this.flyToAsync(void 0,void 0,o,this._tempCenter,i,s,a)}get limits(){return this._limits}_resetToDefault(t){const e=t.radiusMax!==1/0?t.radiusMax:t.planetRadius*4;this.position.copyFromFloats(e,0,0),this._center.copyFromFloats(t.planetRadius,0,0),this._radius=c.Distance(this.position,this.center),this._tempPosition=new c,this._viewMatrix=x.Identity(),this._center.subtractToRef(this._position,this._lookAtVector).normalize(),this.upVector=c.Up(),this._isViewMatrixDirty=!0,this._setOrientation(this._yaw,this._pitch,this._radius,this._center)}_getViewMatrix(){return this._isViewMatrixDirty?(this._isViewMatrixDirty=!1,this.upVector.normalize(),this._lookAtVector.normalize(),this._position.addInPlace(this.perFrameCollisionOffset),this._center.addInPlace(this.perFrameCollisionOffset),this.getScene().useRightHandedSystem?x.LookAtRHToRef(this.position,this._center,this.upVector,this._viewMatrix):x.LookAtLHToRef(this.position,this._center,this.upVector,this._viewMatrix),this._viewMatrix):this._viewMatrix}_isSynchronizedViewMatrix(){return!(!super._isSynchronizedViewMatrix()||this._isViewMatrixDirty)}_applyGeocentricTranslation(){this.center.addToRef(this.movement.panDeltaCurrentFrame,this._tempPosition),this.movement.isInterpolating||this._tempPosition.normalize().scaleInPlace(this.center.length()),this.center=this._tempPosition}_applyGeocentricRotation(){const t=this.movement.rotationDeltaCurrentFrame;if(t.x!==0||t.y!==0){const e=t.x!==0?P(this._pitch+t.x,0,.5*Math.PI-f):this._pitch,i=t.y!==0?this._yaw+t.y:this._yaw;this._setOrientation(i,e,this._radius,this._center)}}_getCenterAndRadiusFromZoomToPoint(t,e,i){const s=j(t,this._position,h.Vector3[0]),a=s.length();if(a<this.limits.radiusMin){i.copyFrom(this._center);const u=this._radius-e;return P(u,this.limits.radiusMin,this.limits.radiusMax)}s.scaleInPlace(e/a);const r=this._position.addToRef(s,h.Vector3[1]),o=V(s,this._lookAtVector),l=this._radius-o,d=P(l,this.limits.radiusMin,this.limits.radiusMax);return i.copyFrom(r).addInPlace(this._lookAtVector.scale(d)),d}_applyZoom(){let t=this.movement.zoomDeltaCurrentFrame;const e=this.movement.computedPerFrameZoomPickPoint;t=this._clampZoomDelta(t,e),!(Math.abs(t)<f)&&(e?this.zoomToPoint(e,t):this.zoomAlongLookAt(t))}_clampZoomDelta(t,e){if(Math.abs(t)<f)return 0;const i=e?A(this._position,e):void 0;return this.limits.clampZoomDistance(t,this._radius,i)}zoomToPoint(t,e){const i=this._getCenterAndRadiusFromZoomToPoint(t,e,this._tempCenter);this._setOrientation(this._yaw,this._pitch,i,this._tempCenter)}zoomAlongLookAt(t){const e=this._radius-t,i=P(e,this.limits.radiusMin,this.limits.radiusMax);this._setOrientation(this._yaw,this._pitch,i,this._center)}_checkInputs(){this.inputs.checkInputs(),this.perFrameCollisionOffset.setAll(0),this.movement.computeCurrentFrameDeltas();let t=!1;this.movement.panDeltaCurrentFrame.lengthSquared()>0&&(this._applyGeocentricTranslation(),t=!0),this.movement.rotationDeltaCurrentFrame.lengthSquared()>0&&this._applyGeocentricRotation(),Math.abs(this.movement.zoomDeltaCurrentFrame)>f&&(this._applyZoom(),t=!0),this._recalculateCenter(t),super._checkInputs()}_recalculateCenter(t){const e=this._wasCenterMovingLastFrame&&!t;if(this._wasCenterMovingLastFrame=t,e){const i=this.movement.pickAlongVector(this._lookAtVector);if(i!=null&&i.pickedPoint){const s=h.Vector3[4];if(s.copyFrom(i.pickedPoint).negateInPlace().normalize(),V(this._lookAtVector,s)>0){const r=A(this._position,i.pickedPoint);if(r>f){const o=h.Vector2[0];Mt(this._lookAtVector,i.pickedPoint,this._scene.useRightHandedSystem,this._yaw,o),this._setOrientation(o.x,o.y,r,i.pickedPoint)}}}}}_getCollisionOffset(t){const e=h.Vector3[6].setAll(0);if(!this.checkCollisions||!this._scene.collisionsEnabled)return e;const i=this.getScene().collisionCoordinator;return i&&(this._collider||(this._collider=i.createCollider()),this._collider._radius.setAll(this.limits.radiusMin),t.subtractToRef(this._position,this._collisionVelocity),i.getNewPosition(this._position,this._collisionVelocity,this._collider,3,null,()=>{},this.uniqueId).subtractToRef(t,e)),e}attachControl(t){this.inputs.attachElement(t)}detachControl(){this.inputs.detachElement()}}function Tt(n,t,e,i,s){const a=h.Vector3[0],r=h.Vector3[1],o=h.Vector3[2];F(e,a,r,o);const l=Math.sin(t),d=Math.cos(t),u=i?1:-1,m=h.Quaternion[0];L.RotationAxisToRef(o,n*u,m);const p=h.Vector3[3];r.rotateByQuaternionToRef(m,p);const _=h.Vector3[4];return s.copyFrom(p).scaleInPlace(l).addInPlace(_.copyFrom(o).scaleInPlace(-d)),s.normalize()}function Mt(n,t,e,i,s){const a=h.Vector3[6],r=h.Vector3[7],o=h.Vector3[8];F(t,a,r,o);const d=-V(n,o),u=P(d,-1,1),m=Math.acos(u),p=h.Vector3[9],_=h.Vector3[10];_.copyFrom(o).scaleInPlace(d),p.copyFrom(n).addInPlace(_);const y=Math.sin(m);if(Math.abs(y)<f)return s.x=i,s.y=m,s;const C=p.scaleInPlace(1/y),k=V(C,r),z=-V(C,a),E=e?1:-1;return s.x=Math.atan2(z,k)*E,s.y=m,s}const Ct=2275207,Rt=6378137,g={enabled:!0,visibleTiles:0,errorTarget:20,minZ:0,maxZ:0},b=new J;b.add(g,"enabled");b.add(g,"visibleTiles").name("Visible Tiles").listen().disable();b.add(g,"errorTarget",1,100);b.add(g,"minZ").name("Camera MinZ").listen().disable();b.add(g,"maxZ").name("Camera MaxZ").listen().disable();const wt=document.getElementById("renderCanvas"),D=new W(wt,!0,{useLargeWorldRendering:!0});D.setHardwareScalingLevel(1/window.devicePixelRatio);const I=new K(D);I.clearColor=new $(.05,.05,.05,1);I.useRightHandedSystem=!0;const M=new gt("geo",I,{planetRadius:Rt});M.attachControl(!0);const It=new ut;M.addBehavior(It);M.radius=5e4;M.center=new c(-3959611825621192e-9,3.3525990363458656e6,3.6975490362687325e6);M.pitch=1.167625429373872;M.yaw=-.2513281792775774;M.checkCollisions=!0;I.collisionsEnabled=!0;let v=!1;const w=new tt(null,I);w.registerPlugin(new et({apiToken:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI3MGNiODVmZS1hNzliLTQ5NWYtOTdhOS02ZmIzMmZlYWRlMzAiLCJpZCI6MjY3NzgzLCJpYXQiOjE3MzY0Mjg0MTJ9.o7EtbJyQ6yNAgfHFal1RS1BKKM-RmZNusqBCeiowNZo",assetId:Ct,autoRefreshToken:!0}));w.errorTarget=g.errorTarget;I.onBeforeRenderObservable.add(()=>{var e;g.enabled&&(w.errorTarget=g.errorTarget,w.update(),g.visibleTiles=w.visibleTiles.size,g.minZ=M.minZ,g.maxZ=M.maxZ,!v&&w.visibleTiles.size>5&&(v=!0,M.flyToAsync(void 0,void 0,300,void 0,2e3)));const n=w.getAttributions(),t=document.getElementById("credits");t.innerText=((e=n[0])==null?void 0:e.value)||""});D.runRenderLoop(()=>{I.render()});window.addEventListener("resize",()=>{D.resize()});
//# sourceMappingURL=googleMapsAerial-BCyKCIrR.js.map
