import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css               */import{M as q,W as I,S as O,a as U}from"./three.module-D-uF--xd.js";import{T as N}from"./TilesRenderer-Bm042Xsy.js";import{G as _}from"./GlobeControls-4ScISV7m.js";import{U as z}from"./UpdateOnChangePlugin-BPSehBEG.js";import{T as j}from"./TilesFadePlugin-BRcOjUD_.js";import{W as k}from"./EPSGTilesPlugin-DX3n6hNw.js";import{L as X}from"./BatchTable-CRr3zuRk.js";import{W as K}from"./constants-JFoaxC9y.js";import{P as $}from"./TiledImageSource-DmD64Gn9.js";import{g as Q}from"./lil-gui.module.min-BH_YJbPT.js";import"./TilesRendererBase-CFsQu8zV.js";import"./B3DMLoader-Cnf0ja_2.js";import"./B3DMLoaderBase-w5mdSgm-.js";import"./GLTFLoader-B4GrkiON.js";import"./PNTSLoader-DwvZQNdL.js";import"./I3DMLoader-BWluRuWb.js";import"./Ellipsoid-Dwquuq5w.js";import"./CMPTLoader-BOTrymv0.js";import"./EllipsoidRegion-VNvPMw5b.js";import"./EnvironmentControls-BRF5UI-K.js";import"./ImageFormatPlugin-DGN9sc3I.js";import"./TMSImageSource-BIqdNmly.js";const E=K*Math.PI*2,P=new $("EPSG:3857");function V(e){return/:4326$/i.test(e)}function J(e){return/:3857$/i.test(e)}function M(e,t){return J(t)&&(e[0]=P.convertNormalizedToLongitude(.5+e[0]/(Math.PI*2*E)),e[1]=P.convertNormalizedToLatitude(.5+e[1]/(Math.PI*2*E)),e[0]*=q.RAD2DEG,e[1]*=q.RAD2DEG),e}function T(e,t,r){const[o,n]=r.split(".").map(a=>parseInt(a)),i=o===1&&n<3||o<1;V(t)&&i&&([e[0],e[1]]=[e[1],e[0]])}function h(e){e[0]*=q.DEG2RAD,e[1]*=q.DEG2RAD}function Y(e,t){if(!e)return null;const r=e.getAttribute("CRS")||e.getAttribute("crs")||e.getAttribute("SRS")||"",o=parseFloat(e.getAttribute("minx")),n=parseFloat(e.getAttribute("miny")),i=parseFloat(e.getAttribute("maxx")),a=parseFloat(e.getAttribute("maxy")),u=[o,n],l=[i,a];return T(u,r,t),T(l,r,t),M(u,r),M(l,r),h(u),h(l),{crs:r,bounds:[...u,...l]}}function Z(e){const t=parseFloat(e.querySelector("westBoundLongitude").textContent),r=parseFloat(e.querySelector("eastBoundLongitude").textContent),o=parseFloat(e.querySelector("southBoundLatitude").textContent),n=parseFloat(e.querySelector("northBoundLatitude").textContent),i=[t,o],a=[r,n];return h(i),h(a),[...i,...a]}function ee(e){const t=parseFloat(e.getAttribute("minx").textContent),r=parseFloat(e.getAttribute("maxx").textContent),o=parseFloat(e.getAttribute("miny").textContent),n=parseFloat(e.getAttribute("maxy").textContent),i=[t,o],a=[r,n];return h(i),h(a),[...i,...a]}function te(e){const t=e.querySelector("Name").textContent,r=e.querySelector("Title").textContent,o=[...e.querySelectorAll("LegendURL")].map(n=>{const i=parseInt(n.getAttribute("width")),a=parseInt(n.getAttribute("height")),u=n.querySelector("Format").textContent,l=n.querySelector("OnlineResource"),x=A(l);return{width:i,height:a,format:u,url:x}});return{name:t,title:r,legends:o}}function F(e,t,r={}){var L,B,R;let{styles:o=[],crs:n=[],contentBoundingBox:i=null,queryable:a=!1,opaque:u=!1}=r;const l=((L=e.querySelector(":scope > Name"))==null?void 0:L.textContent)||null,x=((B=e.querySelector(":scope > Title"))==null?void 0:B.textContent)||"",C=((R=e.querySelector(":scope > Abstract"))==null?void 0:R.textContent)||"",b=[...e.querySelectorAll(":scope > Keyword")].map(d=>d.textContent),D=[...e.querySelectorAll(":scope > BoundingBox")].map(d=>Y(d,t));n=[...n,...Array.from(e.querySelectorAll("CRS")).map(d=>d.textContent)],o=[...o,...Array.from(e.querySelectorAll(":scope > Style")).map(d=>te(d))],e.hasAttribute("queryable")&&(a=e.getAttribute("queryable")==="1"),e.hasAttribute("opaque")&&(u=e.getAttribute("opaque")==="1"),e.querySelector("EX_GeographicBoundingBox")?i=Z(e.querySelector("EX_GeographicBoundingBox")):e.querySelector("LatLonBoundingBox")&&(i=ee(e.querySelector("LatLonBoundingBox")));const H=Array.from(e.querySelectorAll(":scope > Layer")).map(d=>F(d,t,{styles:o,crs:n,contentBoundingBox:i,queryable:a,opaque:u}));return{name:l,title:x,abstract:C,queryable:a,opaque:u,keywords:b,crs:n,boundingBoxes:D,contentBoundingBox:i,styles:o,subLayers:H}}function re(e){var t,r,o;return{name:((t=e.querySelector("Name"))==null?void 0:t.textContent)||"",title:((r=e.querySelector("Title"))==null?void 0:r.textContent)||"",abstract:((o=e.querySelector("Abstract"))==null?void 0:o.textContent)||"",keywords:Array.from(e.querySelectorAll("Keyword")).map(n=>n.textContent),maxWidth:parseFloat(e.querySelector("MaxWidth"))||null,maxHeight:parseFloat(e.querySelector("MaxHeight"))||null,layerLimit:parseFloat(e.querySelector("LayerLimit"))||null}}function A(e){return e?(e.getAttribute("xlink:href")||e.getAttributeNS("http://www.w3.org/1999/xlink","href")||"").trim():""}function oe(e){const t=Array.from(e.querySelectorAll("Format")).map(o=>o.textContent.trim()),r=Array.from(e.querySelectorAll("DCPType")).map(o=>{const n=o.querySelector("HTTP"),i=n.querySelector("Get OnlineResource")||n.querySelector("Get > OnlineResource")||n.querySelector("Get"),a=n.querySelector("Post OnlineResource")||n.querySelector("Post > OnlineResource")||n.querySelector("Post"),u=A(i),l=A(a);return{type:"HTTP",get:u,post:l}});return{formats:t,dcp:r,href:r[0].get}}function ne(e){const t={};return Array.from(e.querySelectorAll(":scope > *")).forEach(r=>{const o=r.localName;t[o]=oe(r)}),t}function W(e,t=[]){return e.forEach(r=>{r.name!==null&&t.push(r),W(r.subLayers,t)}),t}class ie extends X{parse(t){const r=new TextDecoder("utf-8").decode(new Uint8Array(t)),o=new DOMParser().parseFromString(r,"text/xml"),i=(o.querySelector("WMS_Capabilities")||o.querySelector("WMT_MS_Capabilities")).getAttribute("version"),a=o.querySelector("Capability"),u=re(o.querySelector(":scope > Service")),l=ne(a.querySelector(":scope > Request")),x=Array.from(a.querySelectorAll(":scope > Layer")).map(b=>F(b,i)),C=W(x);return{version:i,service:u,layers:C,request:l}}}const ae=window.location.hash.replace(/^#/,"")||"https://basemap.nationalmap.gov/arcgis/services/USGSHydroCached/MapServer/WMSServer?SERVICE=WMS";window.location.hash||(document.getElementById("info").innerHTML='Hydrography data set courtesy of the <a href="https://basemap.nationalmap.gov/arcgis/rest/services">USGS National Map Service</a>.');let p,w,m,s,g,f,c,y;se();function se(){m=new I({antialias:!0}),m.setPixelRatio(window.devicePixelRatio),m.setSize(window.innerWidth,window.innerHeight),m.setClearColor(1118481),m.setAnimationLoop(ue),document.body.appendChild(m.domElement),w=new O,g=new U(60,window.innerWidth/window.innerHeight),ce(),G(),window.addEventListener("resize",G,!1),window.addEventListener("hashchange",()=>location.reload())}async function ce(){var t;y=await new ie().loadAsync(ae+"&request=GetCapabilities");const e=y.layers[0];c={layer:e.name,styles:((t=e.styles[0])==null?void 0:t.name)||"",crs:"EPSG:4326",format:"image/png",tileDimension:256},v(),S()}function v(){f&&f.destroy();const e=y.layers.find(t=>t.name===c.layer);f=new Q,f.add(c,"layer",y.layers.map(t=>t.name)).onChange(t=>{var o;const r=y.layers.find(n=>n.name===t);c.crs=r.crs[0],c.styles=((o=r.styles[0])==null?void 0:o.name)||"",v(),S()}),f.add(c,"styles",e.styles.map(t=>t.name)).onChange(S),f.add(c,"crs",e.crs).onChange(S),f.add(c,"format",y.request.GetMap.formats).onChange(S),f.add(c,"tileDimension",[256,512]).onChange(S)}function S(){s&&(s.dispose(),s=null),p&&(p.dispose(),p=null);const e=y.layers.find(t=>t.name===c.layer);s=new N,s.registerPlugin(new j),s.registerPlugin(new z),s.registerPlugin(new k({shape:"ellipsoid",url:y.request.GetMap.href,layer:c.layer,contentBoundingBox:e.contentBoundingBox,crs:c.crs,format:c.format,tileDimension:c.tileDimension,styles:c.styles,version:y.version})),s.group.rotation.x=-Math.PI/2,w.add(s.group),p=new _(w,g,m.domElement),p.setEllipsoid(s.ellipsoid,s.group),p.enableDamping=!0,p.camera.position.set(0,0,1.75*1e7),p.camera.quaternion.identity(),p.minDistance=150}function G(){const e=window.innerWidth/window.innerHeight;g.aspect=e,g.updateProjectionMatrix(),m.setSize(window.innerWidth,window.innerHeight)}function ue(){p&&(p.update(),g.updateMatrixWorld()),s&&(s.setCamera(g),s.setResolutionFromRenderer(g,m),s.update()),m.render(w,g)}
//# sourceMappingURL=wmsTiles-C9ORl1bG.js.map
