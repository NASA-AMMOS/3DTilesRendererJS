import{d as p}from"./three.module-DBfedTbk.js";import{O as m}from"./Ellipsoid-CLPX16sm.js";const o=new p;class z{constructor(t){t={up:"+z",recenter:!0,lat:null,lon:null,height:0,azimuth:0,elevation:0,roll:0,...t},this.tiles=null,this.up=t.up.toLowerCase().replace(/\s+/,""),this.lat=t.lat,this.lon=t.lon,this.height=t.height,this.azimuth=t.azimuth,this.elevation=t.elevation,this.roll=t.roll,this.recenter=t.recenter,this._callback=null}init(t){this.tiles=t,this._callback=()=>{const{up:l,lat:i,lon:r,height:n,azimuth:s,elevation:a,roll:c,recenter:u}=this;if(i!==null&&r!==null)this.transformLatLonHeightToOrigin(i,r,n,s,a,c);else{const{ellipsoid:h}=t,g=Math.min(...h.radius);if(t.getBoundingSphere(o),o.center.length()>g*.5){const e={};h.getPositionToCartographic(o.center,e),this.transformLatLonHeightToOrigin(e.lat,e.lon,e.height)}else{const e=t.group;switch(e.rotation.set(0,0,0),l){case"x":case"+x":e.rotation.z=Math.PI/2;break;case"-x":e.rotation.z=-Math.PI/2;break;case"y":case"+y":break;case"-y":e.rotation.z=Math.PI;break;case"z":case"+z":e.rotation.x=-Math.PI/2;break;case"-z":e.rotation.x=Math.PI/2;break}t.group.position.copy(o.center).applyEuler(e.rotation).multiplyScalar(-1)}}u||t.group.position.setScalar(0),t.removeEventListener("load-tile-set",this._callback)},t.addEventListener("load-tile-set",this._callback),t.root&&this._callback()}transformLatLonHeightToOrigin(t,l,i=0,r=0,n=0,s=0){const{group:a,ellipsoid:c}=this.tiles;c.getObjectFrame(t,l,i,r,n,s,a.matrix,m),a.matrix.invert().decompose(a.position,a.quaternion,a.scale),a.updateMatrixWorld()}dispose(){const{group:t}=this.tiles;t.position.setScalar(0),t.quaternion.identity(),t.scale.set(1,1,1),this.tiles.removeEventListener("load-tile-set",this._callback)}}export{z as R};
//# sourceMappingURL=ReorientationPlugin-BDRjuvOA.js.map
